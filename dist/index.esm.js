const t=(t,e)=>{const n=document,i={cfg:{orig:t},replace(t,e=t){const i=n.createElement("template");i.innerHTML=e;const o=i.content.firstChild.nextElementSibling;o.nodeName===t.nodeName?this.loop(t,o):t.parentElement.replaceChild(o,t)},loop(e,n,i){(e||n)&&(this.checkNew(e,n,i),e&&n&&e.nodeName!==n.nodeName?this.checkNodeName(e,n):e&&n&&e.nodeName===n.nodeName&&(this.checkCtx(e,n),3!==e.nodeType&&8!==t.nodeType&&this.checkAttrs(e,n))),e&&n&&(e.childNodes&&n.childNodes?this.cfg.lengthDiff=[...t.childNodes,...n.childNodes]:this.cfg.lengthDiff=null,Array.apply(null,this.cfg.lengthDiff).forEach((t,i)=>{this.cfg.lengthDiff&&this.loop(e.childNodes[i],n.childNodes[i],e,n)}))},checkNodeName(t,e){const n=e.cloneNode(!0);t.parentElement.replaceChild(n,t)},checkAttrs(t,e){const n=t.attributes||[],i=Object.keys(n).map(t=>n[t]),o=e.attributes||[],a=Object.keys(o).map(t=>o[t]);i.forEach(n=>null!==e.getAttribute(n.name)?t.setAttribute(n.name,e.getAttribute(n.name)):t.removeAttribute(n.name)),a.forEach(n=>t.getAttribute(n.name)!==e.getAttribute(n.name)&&t.setAttribute(n.name,e.getAttribute(n.name)))},checkCtx(t,e){t.nodeValue!==e.nodeValue&&(t.textContent=e.textContent)},checkNew(t,e,n=this.cfg.orig){if(e&&void 0===t){const t=e.cloneNode(!0);3!==n.nodeType&&8!==n.nodeType&&n.appendChild(t)}else t&&void 0===e&&t.parentElement.removeChild(t)}};Object.create(i).replace(t,e)};function e(n,i){const o=function t(e,n){return t.setState(e,n),e?t:t.container},a=e,s=a.validator,r=a.emitter,l=a.tweenState,c=a.springTo,u=a.storage,h=a.useAudio,d=a.onScroll,f=a.onLoop,p=a.Ctx,m=a.devtools,g=a.memo?a.memo:function(t){return t},y=Object,v=RegExp;let w,b,x,T,C;o.reactive=!0,o.immutable=!0,o.debug=!!m,o.scopedCss=!0,o.state=n,o.schema=i,o.i=(o.log=[{id:0,state:n,action:"init"}]).length,o.view=t=>t,o.middleware=[],o.uid=Math.random().toString(36).split(".")[1],(o.isNode="undefined"!=typeof process&&null!==process&&null!==process.versions&&null!==process.versions.node)||(b=window,x=document,T=requestAnimationFrame,(o.css=x.createElement("style")).id=o.uid,x.head.appendChild(o.css)),o.actions=t=>(o.actionsList=t,y.keys(t).forEach(e=>{if(void 0!==o[e])return!1;o[e]=n=>(o.action=e,t[e](n),o)}),o),o.freeze=g(t=>(y.isFrozen(t)||(y.keys(t).forEach(e=>o.freeze(t[e])),y.freeze(t)),t)),o.eq=g((t,e)=>{const n=y.keys,i=typeof t;return t&&e&&"object"===i&&i===typeof e?n(t).length===n(e).length&&n(t).every(n=>o.eq(t[n],e[n])):String(t)===String(e)}),o.setState=t=>{const e={...o.state,...t};if(u&&!o.done){const n=u.getItem(o,e);n&&(t={...t,...n})}if(o.done=!0,s&&o.schema){const t=g(s(e,o.schema)),n="State doesn't match schema:";if(t.length>0)throw console.error(n,"\n",t,"\n"),new Error(n+"\n"+JSON.stringify(t)+"\n")}if(o.prev=o.state,o.state={...o.state,...e},!o.eq(o.state,o.prev))return u&&o.done&&u.setItem(o,o.state),o.reactive&&o.render(o.container,o.ctx),C&&!o.isNode&&cancelAnimationFrame(C),o.debug&&!0!==o.tt&&(o.isNode&&(T=t=>setTimeout(()=>t(),1)),C=T(()=>{o.log.push({id:o.log.length,state:o.state,action:o.action||"setState"}),o.i=o.log.length-1})),o.immutable&&o.freeze(o.state),void 0!==r&&o.action&&r.emit(""+o.action,{...o.state}),o.middleware.forEach(t=>t({...o.state})),o.action=void 0,o},o.tweenState=(t,e)=>(void 0!==l?l(o,t,e):o(t),o),o.springTo=(t,e)=>(void 0!==c?c(o,t,e):o(t),o),o.useAudio=t=>(void 0!==h?h(t,o):o(t),o),o.onScroll=t=>(d&&d(t,o),o),f&&(o.onLoop=(t,e)=>{o.loop=o.loop?o.loop:new f(e,t,o),o.start=()=>o.loop.start(),o.stop=()=>o.loop.stop(),o.pause=()=>o.loop.pause(),o.resume=()=>o.loop.resume()}),o.on=(t,e)=>(void 0!==r&&r.on(t,e),o),o.once=(t,e)=>(void 0!==r&&r.on(t,n=>{e(n),r.off(t,e)}),o),o.off=(t,e)=>(void 0!==r&&r.off(t,e),o),o.go=function(t,e){let n;return n="f"===e?o.i+t:o.i-t,o.log[n]&&(o.i=n,o.tt=!0,o(o.log[n].state),o.tt=!1),o},o.rw=function(t){return t?o.go(t,"b"):(o.log[0]&&(o.tt=!0,o(o.log[0].state),o.tt=!1),o.i=0,o)},o.ff=function(t){return t?o.go(t,"f"):(o.log[o.log.length-1]&&(o.tt=!0,o(o.log[o.log.length-1].state),o.tt=!1),o.i=o.log.length-1,o)},o.setCss=function(){if(o&&!o.isNode&&o.css&&"function"==typeof o.style){let t=o.style(o.state);if(o.scopedCss){const e=o.container.id?"#":".";let n=o.container.id?o.container.id:o.container.className;n=n||o.uid;const i=new v(n+" ,\\s*\\.","gm"),a=new v(n+" ,\\s*#","gm"),s=new v(n+" ,\\s*([a-z\\.#])","gmi");t=g(((t,e,n)=>t.replace(/}/g,"}\n").replace(/\;\s*\n/g,";").replace(/{\s*\n/g,"{ ").replace(/^\s+|\s+$/gm,"\n").replace(/(^[\.#\w][\w\-]*|\s*,[\.#\w][\w\-]*)/gm,e+n+" $1").replace(i,", "+e+n+" ").replace(a,", "+e+n+" #").replace(s,", "+e+n+" $1").replace(/\n/g,"").replace(/\s\s+/g," "))(t,e,n))}const e=t.replace(/\n/g,"").replace(/\s\s+/g," ");o.css.innerHTML!==e&&(o.css.innerHTML=e)}};return o.toString=function(){let t=o.view(o.state,o.ctx),e="";if(!o.done&&u){const e=u.getItem(o,o.state);o(e),t="function"==typeof o.view?o.view(e,o.ctx):t}return"function"==typeof o.style&&(e=o.style(o.state).replace(/^ {4}/gm,"")),g(((t,e)=>{let n="";if(t.outerHTML)e&&(n=`<style>${e}\n</style>\n`),n+=(""+t.outerHTML).replace(/^ {4}/gm,"");else if("string"==typeof t)try{n=JSON.parse(t),n=JSON.stringify(n,null,2)}catch(i){e&&(n=`<style>${e}\n</style>\n`),n+=(""+t).replace(/^ {4}/gm,"")}else("object"==typeof t||Array.isArray(t))&&(n=JSON.stringify(t,null,2));return n})(t,e))},o.render=function(e,n){if(o.isNode)return o.toString();let i;if(!o.html&&u){const t=u.getItem(o,o.state);i="function"==typeof o.view?o.view(t,o.ctx):null,o(t)}return x&&!o.html&&(e=x.querySelector(e)),(o.html=o.container=e)&&o.html.getContext&&!o.ctx&&(o.ctx=o.html.getContext(n||"2d"))&&p&&(o.ctx=new p(o.ctx,o)),w&&cancelAnimationFrame(w),w=T(()=>{if(o.css&&o.style&&o.setCss(),o.html)if(i="function"==typeof o.view?o.view(o.state,o.ctx):null,o.ctx)o.view(o.state,o.ctx);else try{t(o.html.firstElementChild,i.outerHTML?i.outerHTML:i)}catch(t){i&&i.outerHTML?(o.html.innerHTML="",o.html.append(i)):o.html.innerHTML=i}m&&o.html&&(o.html.firstChild.setAttribute("data-uid",o.uid),m.populateUI(o.html))}),o.html},o.isNode||(b.sjComponents=b.sjComponents||{},b.sjComponents[o.uid]=o),o}const n=(t,e)=>{const n={cfg:{orig:t},replace(t,e=t){const n=document.createElement("template");n.innerHTML=e;const i=n.content.firstElementChild;i.nodeName===t.nodeName?this.loop(t,i):t.parentElement.replaceChild(i,t)},loop(e,n,i){(e||n)&&(this.checkNew(e,n,i),e&&n&&e.nodeName!==n.nodeName?this.checkNodeName(e,n):e&&n&&e.nodeName===n.nodeName&&(this.checkCtx(e,n),3!==e.nodeType&&8!==t.nodeType&&this.checkAttrs(e,n))),e&&n&&(e.childNodes&&n.childNodes?this.cfg.lengthDiff=[...t.childNodes,...n.childNodes]:this.cfg.lengthDiff=null,Array.apply(null,this.cfg.lengthDiff).forEach((t,i)=>{this.cfg.lengthDiff&&this.loop(e.childNodes[i],n.childNodes[i],e,n)}))},checkNodeName(t,e){const n=e.cloneNode(!0);t.parentElement.replaceChild(n,t)},checkAttrs(t,e){const n=t.attributes||[],i=Object.keys(n).map(t=>n[t]),o=e.attributes||[],a=Object.keys(o).map(t=>o[t]);i.forEach(n=>null!==e.getAttribute(n.name)?t.setAttribute(n.name,e.getAttribute(n.name)):t.removeAttribute(n.name)),a.forEach(n=>t.getAttribute(n.name)!==e.getAttribute(n.name)&&t.setAttribute(n.name,e.getAttribute(n.name)))},checkCtx(t,e){t.nodeValue!==e.nodeValue&&(t.textContent=e.textContent)},checkNew(t,e,n=this.cfg.orig){if(e&&void 0===t){const t=e.cloneNode(!0);3!==n.nodeType&&8!==n.nodeType&&n.appendChild(t)}else t&&void 0===e&&t.parentElement.removeChild(t)}};Object.create(n).replace(t,e)};let o;const a=(t,e)=>{if(!window)return i;const i="function"==typeof t?t():t,a=document.querySelector(e);return o&&cancelAnimationFrame(o),o=requestAnimationFrame(()=>{a&&a.nodeName&&i&&n(a,i.outerHTML?i.outerHTML:`<${a.nodeName} ${a.id?`id="${a.id}"`:""} ${a.className?`class="${a.className}"`:""}>${i}</${a.nodeName}>`)}),a};for(var s=("undefined"!=typeof process&&"undefined"!=typeof require?require("perf_hooks").performance:window.performance).now,r="undefined"==typeof window?global:window,l=["moz","webkit"],c="AnimationFrame",u=r["request"+c],h=r["cancel"+c]||r["cancelRequest"+c],d=0;!u&&d<l.length;d++)u=r[l[d]+"Request"+c],h=r[l[d]+"Cancel"+c]||r[l[d]+"CancelRequest"+c];if(!u||!h){var f=0,p=0,m=[];u=function(t){if(0===m.length){var e=s(),n=Math.max(0,1e3/60-(e-f));f=n+e,setTimeout((function(){var t=m.slice(0);m.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(f)}catch(t){setTimeout((function(){throw t}),0)}}),Math.round(n))}return m.push({handle:++p,callback:t,cancelled:!1}),p},h=function(t){for(var e=0;e<m.length;e++)m[e].handle===t&&(m[e].cancelled=!0)}}"undefined"!=typeof module&&(module.exports.raf=function(t){return u.call(r,t)},module.exports.cancel=function(){h.apply(r,arguments)},module.exports.polyfill=function(t){t||(t=r),t.requestAnimationFrame=u,t.cancelAnimationFrame=h});const g={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:(4-2*t)*t-1,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inElastic:t=>(.04-.04/t)*Math.sin(25*t)+1,outElastic:t=>.04*t/--t*Math.sin(25*t),inOutElastic:t=>(t-=.5)<0?(.02+.01/t)*Math.sin(50*t):(.02-.01/t)*Math.sin(50*t)+1,inSin:t=>1+Math.sin(Math.PI/2*t-Math.PI/2),outSin:t=>Math.sin(Math.PI/2*t),inOutSin:t=>(1+Math.sin(Math.PI*t-Math.PI/2))/2,inExpo:t=>0===t?0:Math.pow(2,10*(t-1)),outExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},inOutExpo:function(t){if(0===t||1===t)return t;var e=2*t,n=e-1;return e<1?.5*Math.pow(2,10*n):.5*(2-Math.pow(2,-10*n))},inBack:function(t,e){var n=void 0!==e?e:1.70158;return t*t*((n+1)*t-n)},outBack:function(t,e){var n=void 0!==e?e:1.70158,i=t/1-1;return i*i*((n+1)*i+n)+1},inOutBack:function(t,e=1.70158){var n=2*t,i=n-2,o=1.525*e;return n<1?.5*n*n*((o+1)*n-o):.5*(i*i*((o+1)*i+o)+2)}};var y="undefined"!=typeof process&&"undefined"!=typeof require?require("perf_hooks").performance:window.performance,v="undefined"!=typeof window&&void 0!==window.requestAnimationFrame?window.requestAnimationFrame:function(t){return u.call(r,t)},w=function(){},b=function(){return y&&y.now?y.now():Date.now()},x=function(){function t(t){this._c=t,this._c.ease=g[t.ease]||g[ease],this._c.onUpdate=t.onUpdate||w,this._c.onComplete=t.onComplete||w,this._c.delay=t.delay||0,this._c.duration=t.duration||200,t.paused||this.start()}var e=t.prototype;return e.start=function(){this._c.startTime=b(),function t(e){var n=e.delay,i=e.from,o=e.to,a=e.duration,s=e.startTime,r=e.ease,l=e.onUpdate,c=e.onComplete,u=b()-s;if(n>=u)e.frame=v((function(){return t(e)}))+1;else{var h=Math.min(1,(u-n)/a);e.progress=h;var d,f=i.length?i.map((function(t,e){var n=t+(o[e]-t)*r(h);return Number.isNaN(n)&&(n=t+(o[e]-t)*h),n})):(d=i+(o-i)*r(h),Number.isNaN(d)&&(d=i+(o-i)*h),d);l({...e,values:f}),1===h?c({...e,values:f}):e.frame=v((function(){return t(e)}))+1}}(this._c)},e.cancel=function(){cancelAnimationFrame(this._c.frame)},t}();const T=function(t,e){Object.keys(t).forEach((n,i)=>{if(void 0!==t[n]){if("object"!=typeof t[n])return void e.push(t[n]);T(t[n],e)}})},C=(t,e,n)=>{var i=n.onStart?n.onStart:w,o=n.onUpdate?n.onUpdate:w,a=n.onComplete?n.onComplete:w,s=!n.shouldSetState||n.shouldSetState,r=n.onSetState?n.onSetState:w;"boolean"==typeof s&&(s=()=>s),n.frame=1,n.frameTotal=Math.ceil(.06*(n.delay+n.duration))+2;var l=function(t,e){const n={};return Object.entries(t).forEach(t=>{const i=t[0],o=t[1];e[i]&&(n[i]=o)}),n}(t.state,e),c=[],u=[];return T(l,c),T(e,u),new x({from:c||0,to:u||1,paused:n.paused||!1,delay:n.delay||0,duration:n.duration||200,ease:n.ease||"linear",frame:1,frameTotal:n.frameTotal||1,onUpdate:n=>{var a,l,c=(a=e,l=[...n.values],Object.entries(a).reduce((function t(e,[n,i]){return e[n]=i,"number"==typeof i?e[n]=l.shift():"object"==typeof i&&(e[n]=Object.entries(i).reduce(t,{})),e}),{}));return 1===n.frame&&i(n),s(n)&&(t.setState(c),r(n)),o({...n,tweenedState:c})},onComplete:n=>(t.setState(e),a(n))})},S={on:function(t,e){this._evs=this._evs||{},this._evs[t]=this._evs[t]||[],this._evs[t].push(e)},off:function(t,e){if(this._evs=this._evs||{},t in this._evs==!1)return!1;this._evs[t].splice(this._evs[t].indexOf(e),1)},emit:function(t){if(this._evs=this._evs||{},t in this._evs==!1)return!1;for(var e=0;e<this._evs[t].length;e++)this._evs[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},_=(t,...e)=>(_.funcs=_.funcs||[],t.map((t,n)=>{_.i=_.i||n;var i=e[n]||"";"number"==typeof e[n]&&(i=e[n]);var o="attr";if(t.match(/style=("|')$/i)?o="style":t.match(/data-[a-z0-9\-_]+=("|')$/i)?o="dataAttr":"function"==typeof i&&i.uid&&i.state&&i.setState&&i.render?o="nestedComponent":"function"==typeof i&&"attr"===o&&t.match(/ on[a-z0-9]+=("|')$/i)&&(o="funcAttr"),i.nodeName&&"attr"===o)i=i.outerHTML;else if("nestedComponent"===o&&"function"==typeof i)t+=i.view(i.state),i="";else if("funcAttr"!==o||"function"!=typeof i||i.uid){if(Array.isArray(i))i[0].nodeName&&(i=i.map(t=>""+t.outerHTML)),i=i.join("");else if("object"==typeof i){var a="";if("dataAttr"===o)a+=JSON.stringify(i).trim();else for(var s in i)s&&i&&i.hasOwnProperty(s)&&"object"!=typeof i[s]&&("style"===o&&(a+=`${s}:${i[s]};`),"attr"===o&&(a+=` ${s}="${i[s]}"`));i=a}}else Array.isArray(_.funcs)&&(_.funcs[_.i]=i),i="",t+=_.i;return 0===e[n]&&(i="0"),_.i+=1,t?t+(i||""):""}).join("")),k=(t,...e)=>{var n=_(t,...e).trim();if(!document)return n;var i=document.createElement("template");i.innerHTML=n;for(var o=i.content.firstChild.children.length>0?i.content.firstChild.children:i.content.firstChild,a=0;a<o.length;a++)for(var s=o[a].attributes,r=0;r<s.length;r++){var l=s[r];l.name.match(/^on/)&&(o[a].removeAttribute(l.name),o[a].addEventListener(l.name.replace(/^on/,""),_.funcs[l.value]))}return i.content.firstChild},A="arc arcTo beginPath bezierCurveTo clearRect clip closePath createImageData createLinearGradient createRadialGradient createPattern drawFocusRing drawImage fill fillRect fillText getImageData isPointInPath lineTo measureText moveTo putImageData quadraticCurveTo rect restore rotate save scale setTransform stroke strokeRect strokeText transform translate".split(" "),E="canvas fillStyle font globalAlpha globalCompositeOperation lineCap lineJoin lineWidth miterLimit shadowOffsetX shadowOffsetY shadowBlur shadowColor strokeStyle textAlign textBaseline".split(" ");function M(t,e,n){return function(){return t.apply(e,arguments)||n}}function N(t,e,n){return function(i){return void 0===i?e[t]:(e[t]=i,n)}}const R=window&&window.devicePixelRatio||1,P=Math.PI,F=2*P,q=P/2,I=180/P,O=P/180;function j(t,e){let n=document.createElement("a"),i=URL.createObjectURL(t),o=e||"canvas-"+(new Date).valueOf();n.target="_blank",n.href=i,n.download=o,n.click(),window.URL.revokeObjectURL(i)}const z={clear:function(t){!0===t&&this.setTransform(1,0,0,1,0,0),this.clearRect(0,0,this.canvas.width*R,this.canvas.height*R)},fullscreen:function(){document.fullscreenElement?document.exitFullscreen():this.canvas.requestFullscreen()},isClean:function(){try{this.getImageData(0,0,1,1);return!0}catch(t){return!1}},size:function(t,e,n){this.w===t&&this.h===e||(this.w=t||e*n,this.h=e||t*n,this.canvas.width=this.w*R,this.canvas.height=this.h*R,this.canvas.style.width=this.w+"px",this.canvas.style.height=this.h+"px",this.canvas.style.objectFit=n?"contain":null,"2d"===this.contextType&&1!==R&&this.scale(R,R))},camera:function(t=0,e=0,n=1,i=0){this.resetTransform(),this.translate(t,e),this.rotate(i*O),this.scale(n,n),this.translate(-t,-e)},chromaKey:function(t=150,e=[0,255,0]){const n=t>250?250:t,i=this.getImageData(0,0,this.canvas.width,this.canvas.height),o=i.data;let a;if(e[1]>e[0]&&e[1]>e[2])for(let t=0,e=o.length;t<e;t+=4)o[t+1]>50&&o[t+1]>o[t]&&o[t+1]>o[t+2]&&(o[t+3]=0);else for(let t=0,i=o.length;t<i;t+=4)a=Math.abs(e[0]-o[t+0])+Math.abs(e[1]-o[t+1])+Math.abs(e[2]-o[t+2]),a<n&&(o[t+3]=a*a/n);this.putImageData(i,0,0)},line:function(t,e,n,i,o=[]){this.beginPath(),this.save(),this.setLineDash(o),this.moveTo(t,e),this.lineTo(n,i),this.closePath(),this.fill(),this.stroke(),this.restore()},circle:function(t,e,n,i=360,o){this.beginPath(),this.arc(t,e,n,0,i*O,o),this.lineTo(t,e),this.closePath()},fillCircle:function(t,e,n,i){z.circle.apply(this,[t,e,n,i]),this.fill()},strokeCircle:function(t,e,n,i){z.circle.apply(this,[t,e,n,i]),this.stroke()},ellipse:function(t,e,n,i){let o,a,s,r,l,c,u;o=.5522848,a=n/2*.5522848,s=i/2*.5522848,r=t+n,c=e+i,l=t+n/2,u=e+i/2,this.moveTo(t,u),this.bezierCurveTo(t,u-s,l-a,e,l,e),this.bezierCurveTo(l+a,e,r,u-s,r,u),this.bezierCurveTo(r,u+s,l+a,c,l,c),this.bezierCurveTo(l-a,c,t,u+s,t,u)},fillEllipse:function(t,e,n,i){this.beginPath(),z.ellipse.apply(this,[t,e,n,i]),this.closePath(),this.fill()},strokeEllipse:function(t,e,n,i){this.beginPath(),z.ellipse.apply(this,[t,e,n,i]),this.closePath(),this.stroke()},ring:function(t,e,n,i){this.beginPath(),this.arc(t,e,n,0,F,!1),this.moveTo(i,0),this.arc(t,e,i,F,0,!0),this.closePath()},fillRing:function(t,e,n,i){z.ring.apply(this,[t,e,n,i]),this.fill()},strokeRing:function(t,e,n,i){z.ring.apply(this,[t,e,n,i]),this.stroke()},gradientCircle:function(t,e,n,i,o=0,a=0,s){const r=this.createRadialGradient(t+o,e+a,i,t+o,e+a,n);for(let t=0;t<s.length;t++)r.addColorStop(s[t][0],s[t][1]);this.fillStyle=r,z.circle.apply(this,[t,e,i]),this.fill(),this.closePath()},gradientRect:function(t,e,n,i,o,a=!0){if(o){const s=a?this.createLinearGradient(t,e,t,e+i):this.createLinearGradient(t,e,t+n,e);for(let t=0;t<o.length;t++)s.addColorStop(o[t][0],o[t][1]);this.fillStyle=s,this.fillRect(t,e,n,i),this.closePath()}},roundedRect:function(t,e,n,i,o){this.moveTo(t+o,e),this.arcTo(t+n,e,t+n,e+o,o),this.arcTo(t+n,e+i,t+n-o,e+i,o),this.arcTo(t,e+i,t,e+i-o,o),this.arcTo(t,e,t+o,e,o),this.closePath()},fillRoundedRect:function(t,e,n,i,o){this.beginPath(),z.roundedRect.apply(this,[t,e,n,i,o]),this.fill()},strokeRoundedRect:function(t,e,n,i,o){this.beginPath(),z.roundedRect.apply(this,[t,e,n,i,o]),this.stroke()},polygon:function(t,e=[],n=!0){this.beginPath(),n&&this.save(),this.setLineDash(e);const i=t[0][0],o=t[0][1];this.moveTo(i,o),t.shift(),t.forEach(t=>this.lineTo(t[0],t[1])),this.closePath(),n&&this.restore()},fillPolygon:function(t,e=[]){z.polyshape.apply(this,[t,e,!1]),this.fill(),this.restore()},strokePolygon:function(t,e=[]){z.polyshape.apply(this,[t,e,!1]),this.stroke(),this.restore()},polyshape:function(t,e,n,i,o){const a={x:t,y:e},s=i||6,r=o||0;this.translate(a.x,a.y),this.rotate(r*O),this.beginPath(),this.moveTo(n,0);for(var l=0;l<=F;l+=P/(s/2))this.lineTo(n*Math.cos(l),n*Math.sin(l));this.closePath(),this.rotate(-r*O),this.translate(-a.x,-a.y)},fillPolyshape:function(t,e,n,i,o){z.polyshape.apply(this,[t,e,n,i,o]),this.fill()},strokePolyshape:function(t,e,n,i,o){z.polyshape.apply(this,[t,e,n,i,o]),this.stroke()},star:function(t,e,n,i,o){const a={x:t,y:e},s=2*(i||5),r=-90-(o||0);this.translate(a.x,a.y),this.rotate(r*O),this.beginPath(),this.moveTo(n,0);let l=2;for(var c=0;c<=F;c+=P/(s/2))l=1==l?2:1,this.lineTo(n/l*Math.cos(c),n/l*Math.sin(c));this.closePath(),this.rotate(-r*O),this.translate(-a.x,-a.y)},fillStar:function(t,e,n,i,o){z.star.apply(this,[t,e,n,i,o]),this.fill()},strokeStar:function(t,e,n,i,o){z.star.apply(this,[t,e,n,i,o]),this.stroke()},square:function(t,e,n){this.beginPath(),this.rect(t,e,n,n),this.closePath()},triangle:function(t,e,n,i){z.polyshape.apply(this,[t,e,n,3,i||-90])},fillTriangle:function(t,e,n,i){z.polyshape.apply(this,[t,e,n,3,i||-90]),this.fill()},strokeTriangle:function(t,e,n,i){z.polyshape.apply(this,[t,e,n,3,i||-90]),this.stroke()},curve:function(t,e,n,i){let o;e="number"==typeof e?e:.5,n=n||20;let a,s=[],r=t.length,l=new Float32Array(4*(n+2)),c=4;for(o=t.slice(0),i?(o.unshift(t[r-1]),o.unshift(t[r-2]),o.push(t[0],t[1])):(o.unshift(t[1]),o.unshift(t[0]),o.push(t[r-2],t[r-1])),l[0]=1,a=1;a<n;a++){let t=a/n,e=t*t,i=e*t,o=2*i,s=3*e;l[c++]=o-s+1,l[c++]=s-o,l[c++]=i-2*e+t,l[c++]=i-e}function u(t,i,o){for(let a=2;a<o;a+=2){let o=t[a],r=t[a+1],l=t[a+2],c=t[a+3],u=(l-t[a-2])*e,h=(c-t[a-1])*e,d=(t[a+4]-o)*e,f=(t[a+5]-r)*e;for(let t=0;t<=n;t++){const e=4*t;s.push(i[e]*o+i[e+1]*l+i[e+2]*u+i[e+3]*d,i[e]*r+i[e+1]*c+i[e+2]*h+i[e+3]*f)}}}for(l[++c]=1,u(o,l,r),i&&(o=[],o.push(t[r-4],t[r-3],t[r-2],t[r-1]),o.push(t[0],t[1],t[2],t[3]),u(o,l,4)),a=0,r=s.length;a<r;a+=2)this.lineTo(s[a],s[a+1]);return s},drawGridBox(t,e,n,i,o,a=.1,s="#444"){this.save(),this.lineWidth=a,this.strokeStyle=s,this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+i),this.lineTo(t,e+i),this.lineTo(t,e);for(let a=1;a<n/o;a++)this.moveTo(t+o*a,e),this.lineTo(t+o*a,e+i);for(let a=1;a<i/o;a++)this.moveTo(t,e+o*a),this.lineTo(t+n,e+o*a);this.stroke(),this.closePath(),this.restore()},drawGrid(t,e=.1,n="#444"){z.drawGridBox.apply(this,[0,0,this.canvas.width,this.canvas.height,t,e,n])},checkerboard:function(t,e,n,i,o,a,s){const r=n/o|0,l=i/o|0;let c;this.save(),this.rect(t,e,n,i);for(var u=0;u<=r;u++)for(var h=0;h<=l;h++)c=h%2?u%2?a:s:u%2?s:a,this.fillStyle=c,this.fillRect(t+u*o,e+h*o,o,o);this.restore()},cacheImg:function(t,e,n,i,o,a,s,r,l){return this.cache[t]||(this.cache[t]=new Image,this.cache[t].onload=()=>(this.cache[t].width=i,this.cache[t].height=o,a?this.drawImage(this.cache[t],e,n,i,o,a,s,r,l):this.drawImage(this.cache[t],e,n,i,o)),this.cache[t].crossOrigin="anonymous"),this.cache[t]},drawImg:function(t,e,n,i,o,a,s,r,l){return t.outerHTML?a?this.drawImage(t,e,n,i,o,a,s,r,l):this.drawImage(t,e,n,i,o):(this.cache||(this.cache={}),this.cache[t]&&this.cache[t].src?a?this.drawImage(this.cache[t],e,n,i,o,a,s,r,l):this.drawImage(this.cache[t],e,n,i,o):void(z.cacheImg.apply(this,[t,e,n,i,o,a,s,r,l]).src=t.includes("<svg")?"data:image/svg+xml; charset=utf8,"+encodeURIComponent(t):t))},setStyle:function(t){for(i in t)this[i]=t[i]},angleFromPoints:function(t,e,n,i){return Math.atan2(i-n,e-t)},angleToTarget:function(t,e,n,i){return Math.atan2(i-e,n-t)+q},clamp:function(t,e,n){return Math.min(Math.max(e,t),n)},distance:function(t,e,n,i){return Math.sqrt(Math.pow(t-e,2)+Math.pow(n-i,2))},seededRandom:function(t){for(var e=0,n=2166136261;e<t.length;e++)n=Math.imul(n^t.charCodeAt(e),16777619);n+=n<<13,n^=n>>>7,n+=n<<3,n^=n>>>17;let i=(n+=n<<5)>>>0,o=()=>(2**31-1&(i=Math.imul(48271,i)))/2**31;return o(),o},random:function(t,e,n){return n?Math.random()*(e-t)+t:Math.floor(Math.random()*(e-t+1))+t},randomFrom(t){return z.random.apply(this,[1,t.length])},rotateAt:function(t,e,n){this.translate(t,e),this.rotate(n*O),this.translate(-t,-e)},toRad:function(t){return t*O},toDeg:function(t){return t*I}},D=Object.keys(z);window.Ctx=function(t,e){let n,i,o=A.length;const a=function(){let t=null,e=["video/webm","video/webm;codecs=vp9","video/vp8","video/webm;codecs=vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mp4","video/mpeg"];for(let n in e)if(MediaRecorder.isTypeSupported(e[n])){t=e[n];break}return t}();for(this.context=t;o--;)n=A[o],this[n]=M(t[n],t,this);for(o=D.length;o--;)n=D[o],this[n]=M(z[n],t,this);for(o=E.length;o--;)n=E[o],this[n]=N(n,t,this);this.canvas=t.canvas,this.image={saveAs:function(t){this.canvas.toBlob(e=>j(e,t))},toElement:function(t){const e=new Image,{w:n,h:i}=this;e.onload=function(){e.width=n,e.height=i,t(e)},e.crossOrigin="anonymous",e.src=this.canvas.toDataURL("image/png")}},this.video={record:(t,e=a,n=128e3,o=25e5)=>{if(!0===this.isRecording)return!0;const s=t>0&&t<=60?t:24;i=[];const r={audioBitsPerSecond:n,videoBitsPerSecond:o,mimeType:e},l=this.canvas.captureStream(s);this.rec=new MediaRecorder(l,r),this.rec.ondataavailable=function(t){i.push(t.data)},this.rec.onstop=t=>(this.videoBlob=new Blob(i,{type:e}),i=[],this.isRecording=!1,this.rec=null,this.videoBlob),this.rec.onstart=t=>this.isRecording=!0,this.rec.onresume=t=>this.isRecording=!0,this.rec.onpause=t=>{this.isRecording=!1,this.videoBlob=new Blob(i,{type:e})},this.rec.start()},stop:()=>{if(!this.isRecording)throw Error("No video is recording");return this.rec.stop()},saveAs:t=>{setTimeout(()=>{if(this.isRecording&&this.rec.stop(),!this.videoBlob)throw Error("No video to save");j(this.videoBlob,t),this.videoBlob=null},64)},toElement:t=>{setTimeout(()=>{if(!this.videoBlob)throw Error("No video to export");const e=document.createElement("video"),{w:n,h:i}=this;e.width=n,e.height=i,e.crossOrigin="anonymous",e.src=URL.createObjectURL(this.videoBlob),e.load(),t(e)},64)}}};var L=Ctx;const H={getItem:(t,e)=>{if(!t.store)return e;const n=JSON.parse(localStorage.getItem(t.store));return n?{...e,...n}:e},setItem:(t,e)=>{if(!t.store)return e;!t.isNode&&Component.syncTabs&&(window.syncTab=window.syncTab||[],window.syncTab[t.uid]||Component.syncTabs(t)),localStorage.setItem(t.store,JSON.stringify(e))}},B=function(t){!t.isNode&&window&&(window.addEventListener("storage",(function(e){if(e.key===t.store){let n=JSON.parse(e.newValue);t.setState({...t.state,...n})}})),window.syncTab[t.uid]=!0)},$=function(t,e){if(!document||!window||"object"!=typeof t)return;const n=Array.isArray,i=function(){},o=window.AudioContext||window.webkitAudioContext;window.audioCtx=window.audioCtx?window.audioCtx:new o,audioCtx.createGain||(audioCtx.createGain=audioCtx.createGainNode),audioCtx.createDelay||(audioCtx.createDelay=audioCtx.createDelayNode);const a={};let s=null,r=null,l=!1;const c=["gain","panning","reverb","equalizer","lowpass","lowshelf","peaking","notch","highpass","highshelf","bandpass","allpass","compression","analyser"],u={};window.totalFiles=window.totalFiles?window.totalFiles:0,window.totalFiles+=Object.keys(t).length,window.loadedFiles=window.loadedFiles?window.loadedFiles:0;const h=(t,e)=>{u[s]=f(t),a[s]=p(e),a.settings=(t,e)=>(Object.keys(a).forEach(e=>{a[e]&&"settings"!==e&&a[e].settings&&a[e].settings(t)}),"function"==typeof e&&e(a[audioObj].state),a),d(),!0===a[s].autoplay&&a[s].play()},d=()=>{window.loadedFiles+=1,window.totalFiles===window.loadedFiles&&document.dispatchEvent(new CustomEvent("audioLoaded",{detail:a}))},f=t=>{let e=audioCtx.createBuffer(t?t.numberOfChannels:2,t?t.length:0,t?t.sampleRate:audioCtx.sampleRate);for(var n=0,i=t.numberOfChannels;n<i;++n){let i=e.getChannelData(n),o=t.getChannelData(n);i.set(o,0)}return e},p=t=>{const e={name:s,src:r,play:x,playFrom:_,pause:S,fadeIn:R,fadeOut:P,rapidFire:C,stop:k,mute:A,unmute:E,connectTo:M,onPlay:t[1].onPlay||i,onPause:t[1].onPause||i,onResume:t[1].onResume||i,onStop:t[1].onStop||i,onChange:t[1].onChange||i,input:audioCtx.createBufferSource(),output:audioCtx.destination,audioNodes:[],state:{isPlaying:!1,volume:t[1].volume||1,muted:t[1].muted||!1,autoplay:t[1].autoplay||!1,loop:t[1].loop||!1,playbackRate:t[1].playbackRate||1,startTime:t[1].startTime||0,startOffset:t[1].startOffset||0},settings:function(t,n){return Object.keys(t).forEach(n=>{-1!==c.indexOf(n)&&y(e.state[n])!==y(t[n])&&(e.state={...e.state,...t},e.audioNodes=v(e),T(e),e.state.isPlaying&&e.playFrom(audioCtx.currentTime))}),e.state={...e.state,...t},m(e),g(e),"function"==typeof n&&n(e.state),e.onChange(e.state),e}};return e.audioNodes=v(e),e},m=t=>{const e=t.state;if("object"==typeof e.randomization){const n=e.randomization;n.volume&&(e.volume=e.volume+Math.random()*n.volume),n.playbackRate&&(e.playbackRate=e.playbackRate+Math.random()*n.playbackRate),n.startOffset&&(e.startOffset=e.startOffset+1*(.01+Math.random()*n.startOffset)),n.delay&&N(t,"delay")&&(e.delay=e.delay*(.01+Math.random()*n.delay))}},g=t=>{const e=t.state;t.input.loop=e.loop,t.input.playbackRate.value=e.playbackRate,Object.keys(e).forEach(n=>{let i=N(t,"volume"===n?"gain":n);i&&!y(e[n])&&b(t,i,e[n])})},y=t=>null==t||!1===t,v=t=>{const e=[t.input],i={},o={gain:t.state.volume,...l,...t.state};return Object.keys(o).forEach(e=>{const n=o[e];if(y(n))return;i[e]=w(t,e,n);const a="gain"===e?"volume":e;t.state[a]=n,i[e]&&b(t,i[e],n)}),c.forEach(o=>{i[o]&&"equalizer"!==o?e.push(i[o]):"equalizer"===o&&n(t.eq)&&t.eq.forEach(t=>e.push(t))}),e.push(t.output),e},w=(t,e,n)=>{let i=void 0;switch(e){case"gain":case"volume":i=audioCtx.createGain();break;case"panning":i=audioCtx.createStereoPanner?audioCtx.createStereoPanner():audioCtx.createPanner();break;case"delay":i=audioCtx.createDelay();break;case"lowpass":case"highpass":case"bandpass":case"allpass":case"lowshelf":case"highshelf":case"peaking":case"notch":i=audioCtx.createBiquadFilter();break;case"equalizer":i={type:"equalizer"},t.eq=[],n.forEach((e,i)=>{const o=audioCtx.createBiquadFilter();0===i?o.type="lowpass":i===n.length-1?o.type="highpass":o.type="peaking",t.eq.push(o)});break;case"reverb":i=audioCtx.createConvolver();break;case"analyser":i=audioCtx.createAnalyser();break;case"compression":i=audioCtx.createDynamicsCompressor()}return i&&(i.type=e),i},b=(t,e,i)=>{const o=e.type,a=audioCtx.currentTime,s=t=>"number"==typeof i||"number"==typeof i[t],r=(t,n)=>e[t].setValueAtTime(n,a);switch(o){case"volume":case"gain":let o=i<=0?1e-5:i;!0===t.state.mute&&(o=1e-5),e.gain.setValueAtTime(o,a);break;case"panning":if(audioCtx.createStereoPanner)r("pan","number"==typeof i?i:0);else{const t=0,n=1-Math.abs(i);e.setPosition(i,t,n),e.panValue=i}break;case"delay":r("delayTime","number"==typeof i?i:0);break;case"lowpass":case"highpass":case"bandpass":case"allpass":case"lowshelf":case"highshelf":case"peaking":case"notch":s("freq")&&e.frequency.setValueAtTime(i.freq,a),s("gain")&&e.gain.setValueAtTime(i.gain,a),s("q")&&e.Q.setValueAtTime(i.q,a);break;case"reverb":if(i){const n={duration:1,decay:1,reverse:!1,...t.state.reverb,...i};e.buffer=function(t,e,n){const i=audioCtx.sampleRate*t,o=audioCtx.createBuffer(2,i,audioCtx.sampleRate),a=o.getChannelData(0),s=o.getChannelData(1);let r;if(n)for(let t=0;t<i;t++){r=i-t;let n=Math.pow(1-r/i,e);a[r]=.5*Math.random()*n,s[r]=.5*Math.random()*n}else for(let t=0;t<i;t++){r=t;let n=Math.pow(1-r/i,e);a[t]=.5*Math.random()*n,s[t]=.5*Math.random()*n}return o}(n.duration,n.decay,n.reverse),t.state.reverb=n}else e.buffer=null;break;case"equalizer":n(t.eq)&&i.forEach((e,n)=>{const i=t.eq[n];"number"==typeof e.freq&&(i.frequency.value=e.freq),"number"==typeof e.gain&&(i.gain.value=e.gain),"number"==typeof e.q&&(i.Q.value=e.q)});break;case"analyser":s("fftSize")&&(e.fftSize=i.fftSize),s("minDecibels")&&(e.minDecibels=i.minDecibels),s("maxDecibels")&&(e.maxDecibels=i.maxDecibels),s("smoothingTimeConstant")&&(e.smoothingTimeConstant=i.smoothingTimeConstant),t.state.visualiser=e;break;case"compression":s("threshold")&&r("threshold",i.threshold),s("knee")&&r("knee",i.knee),s("ratio")&&r("ratio",i.ratio),s("attack")&&r("attack",i.attack),s("release")&&r("release",i.release)}},x=()=>{const t=a[s],e=t.state,i=audioCtx.createBufferSource();i.buffer=f(u[s]),m(t),i.loop=e.loop,i.playbackRate.value=e.playbackRate,t.input=i,t.audioNodes=v(t),T(t),g(t),i.start||(i.start=i.noteOn),i.start(e.startTime,e.startOffset%i.buffer.duration),e.isPlaying=!0,n(t.attachedSounds)&&t.attachedSounds.forEach(t=>{t.state.isPlaying||t.playFrom(audioCtx.currentTime)}),"number"==typeof e.fadeIn&&e.fadeIn>0&&R(e.fadeIn),0===e.startOffset&&t.onPlay(e),e.startOffset>0&&t.onResume(e)},T=t=>{t.audioNodes.forEach((e,n)=>{const i=e,o=t.audioNodes[n+1],a=n>0?t.audioNodes[n-1]:null;i&&o&&i.connect&&("equalizer"===o.type?(i.connect(t.eq[0]),t.eq.forEach((e,n)=>{t.eq[n]&&t.eq[n+1]&&t.eq[n].connect(t.eq[n+1])})):a&&"equalizer"===a.type?(t.eq[t.eq.length-1].connect(i),i.connect(o)):i.connect(o))})},C=(t,e)=>{const n=t||3,i=e||200;for(let t=0;t<n;t++){const t=a[s].state.loop;a[s].state.loop=!1,setTimeout(x,i),a[s].state.loop=t}},S=()=>{a[s].state.isPlaying&&(a[s].state.startOffset=audioCtx.currentTime-a[s].state.startTime,a[s].input.stop(0),a[s].state.isPlaying=!1,a[s].onPause(a[s].state),n(a[s].attachedSounds)&&a[s].attachedSounds.forEach(t=>{t.state.isPlaying&&t.pause()}))},_=t=>{try{a[s].input.stop(0)}catch(t){}a[s].state.startOffset=t,a[s].play()},k=()=>{a[s].state.isPlaying&&(a[s].input.stop(0),a[s].state.isPlaying=!1,a[s].state.startOffset=0,a[s].onStop(a[s].state),n(a[s].attachedSounds)&&a[s].attachedSounds.forEach(t=>{t.state.isPlaying&&t.stop()}))},A=()=>{a[s].state.prevVol=a[s].state.volume,a[s].settings({volume:0,muted:!0}),n(a[s].attachedSounds)&&a[s].attachedSounds.forEach(t=>{t.state.isPlaying&&t.mute()})},E=()=>{a[s].settings({volume:a[s].state.prevVol,prevVol:void 0,muted:!1}),n(a[s].attachedSounds)&&a[s].attachedSounds.forEach(t=>{t.state.isPlaying&&t.unmute()})},M=t=>{t.attachedSounds=t.attachedSounds||[],t.attachedSounds.push(a[s]),a[s].onChange(a[s].state)},N=(t,e)=>{if(t.audioNodes)return t.audioNodes.filter(t=>t.type===e)[0]},R=function(t,e){a[s].state.isPlaying||a[s].play(),F(e||1,t)},P=function(t){F(1e-5,t)},F=function(t,e){const n=N(a[s],"gain"),i=audioCtx.currentTime,o=a[s].state;n.gain.value=o.volume,o.isPlaying&&(n.gain.setValueAtTime(o.volume,i),n.gain.exponentialRampToValueAtTime(t,i+e),o.volume=t)};return Object.entries(t).forEach(t=>{const e="object"==typeof t[1]&&"object"==typeof t[1].filters;s=t[1].name||t[0],r=t[1].src||t[1],l=e?t[1].filters:void 0,a[s]=null,u[s]=null,((t,e)=>{if(u[s])return void h(u[s]);const n=new XMLHttpRequest;n.open("GET",t),n.responseType="arraybuffer",n.onload=function(){let t=n.response;audioCtx.decodeAudioData(t,(function(t){h(t,e)}))},n.onprogress=function(e){let n=0;return e.lengthComputable&&(n=e.loaded/e.total*100),document.dispatchEvent(new CustomEvent("audioProgress",{detail:{percent:n,url:t}})),n},n.send()})(r,t)}),e&&(e.audio=a),a},V=(t,e)=>{if(!document)return;const n=function(){document.body.getBoundingClientRect();const n=e.onScroll.offset||35,i=document.documentElement.clientHeight/100*n;requestAnimationFrame(n=>{const o=e.html.getBoundingClientRect(),a=o.top>i||o.bottom<i;let s=(i-o.top)/o.height;o.top>=i&&(s=0),o.bottom<=i&&(s=1),e.onScroll.frame=a?0:(e.onScroll.frame||0)+1;let r=null;0!==e.onScroll.frame&&(r=e.onScroll.prevPos<s?"down":"up");const l={frame:e.onScroll.frame,totalFrames:+n.toFixed(0),progress:+s.toFixed(2),direction:r};t(l),e.onScroll.prevPos=s})};e.onScroll.ready||(window.addEventListener("scroll",n),e.onScroll.ready=!0)};class U{id=0;running=!1;fn=()=>{};usingSetTimeout=!1;constructor(){const t=this;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||function(){clearTimeout(t.id)}}start(t,e){this.running||(this.running=!0,this.fn=t,e?(this.usingSetTimeout=!0,this.updateTimeout()):window.requestAnimationFrame(t=>this.updateRAF(t)))}updateRAF(t){this.running=!0,this.fn(t),this.id=window.requestAnimationFrame(t=>this.updateRAF(t))}updateTimeout(){let t=window.performance.now();this.fn(t),this.id=window.setTimeout(()=>this.updateTimeout(),1e3/60)}restart(){this.usingSetTimeout?window.clearTimeout(this.id):window.cancelAnimationFrame(this.id),this.id=0,this.running=!1,this.usingSetTimeout?this.updateTimeout():window.requestAnimationFrame(t=>this.updateRAF(t)),this.running=!0}stop(){this.usingSetTimeout?window.clearTimeout(this.id):window.cancelAnimationFrame(this.id),this.id=0,this.running=!1,this.fn=()=>{}}}class G{minFps=15;targetFps=60;maxRestarts=1/0;runTime=1/0;forceSetTimeout=!1;autoResume=!0;constructor(t={}){Object.assign(this,t)}get minFpsCalc(){return Math.floor(1e3/this.minFps)}get targetFpsCalc(){return Math.floor(1e3/this.targetFps)}}class Q{_options;_restartAttempts;_running;_paused;_fn;_c;_raf;_frame;_time;_prevTime;_delta;_deltaAverage;_deltaHistory;_deltaIndex;_hidden;constructor(t,e,n){this._options=new G(t),this._restartAttempts=0,this._running=!1,this._paused=!1,this._fn=e,this._c=n,this._frame=0,this._time=0,this._prevTime=0,this._delta=0,this._deltaAverage=0,this._deltaHistory=[],this._deltaIndex=0,this._raf=new U,this._hidden=document.hidden,this._boot()}get timesRestarted(){return this._restartAttempts}get isRunning(){return this._running}get isPaused(){return this._paused}get frame(){return this._frame}get time(){return this._time}start(){this._prevTime=0,this._running=!0,this._raf.start(t=>this._update(t),this._options.forceSetTimeout)}pause(){this._paused=!0,this._running=!1}resume(){this._paused=!1,this._prevTime=window.performance.now(),this._running=!0}stop(){this._restartAttempts=0,this._running=!1,this._paused=!1,this._fn=()=>{},this._frame=0,this._time=0,this._prevTime=0,this._delta=0,this._deltaHistory=[],this._deltaIndex=0,document.removeEventListener("visibilitychange",()=>this._visibilityChange),this._raf.stop()}_boot(){document.addEventListener("visibilitychange",()=>this._visibilityChange())}_update(t){if(this._paused)return;if(t>=this._options.runTime)return void this.stop();this._time=t,this._delta=t-this._prevTime,10===this._deltaIndex&&(this._deltaIndex=0),this._deltaHistory[this._deltaIndex]=this._delta,this._deltaIndex++;let e=0;for(let t=0;t<this._deltaHistory.length;++t)e+=this._deltaHistory[t];if(e/=10,this._deltaAverage=e,this._deltaAverage>=this._options.minFpsCalc){if(this._restartAttempts===this._options.maxRestarts)return void this.stop();this._raf.restart(),this._restartAttempts++}this._deltaAverage>=this._options.targetFpsCalc&&(this._frame++,this._fn(this._c.state,this._delta,this._deltaAverage,t),this._prevTime=t)}_visibilityChange(){const t=document.visibilityState;this.isPaused&&this._options.autoResume&&"visible"===t?this.resume():this.isRunning&&"hidden"===t&&this.pause()}}var J="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var W=function(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}((function(t){var e,n;e=J,n=function(){var t=new WeakMap,e=[];return{useHooks:function(...t){return(t=t.map((function(t){return i.reset=function(){e.push(i);var t=n();try{for(let e of t.cleanups)"function"==typeof e&&e()}finally{e.pop(),t.stateSlots.length=0,t.effects.length=0,t.cleanups.length=0,t.memoizations.length=0,t.nextStateSlotIdx=0,t.nextEffectIdx=0,t.nextMemoizationIdx=0}},i;function i(...o){e.push(i);var a=n();a.nextStateSlotIdx=0,a.nextEffectIdx=0,a.nextMemoizationIdx=0;try{return t.apply(this,o)}finally{try{!function(t){for(let[e,[n,i]]of t.effects.entries())try{"function"==typeof n&&n()}finally{t.effects[e][0]=void 0}}(a)}finally{e.pop()}}}}))).length<2?t[0]:t},useState:i,useReducer:o,useEffect:function(t,...e){e.length>0?1==e.length&&Array.isArray(e[0])&&(e=e[0]):e=void 0;var i=n();if(!i)throw new Error("useEffect() only valid inside an Articulated Function or a Custom Hook.");{i.nextEffectIdx in i.effects||(i.effects[i.nextEffectIdx]=[]);let n=i.nextEffectIdx,o=i.effects[n];a(o[1],e)&&(o[0]=function(){if("function"==typeof i.cleanups[n])try{i.cleanups[n]()}finally{i.cleanups[n]=void 0}var e=t();"function"==typeof e&&(i.cleanups[n]=e)},o[1]=e),i.nextEffectIdx++}},useMemo:s,useCallback:function(t,...e){if(n())return s((function(){return t}),...e);throw new Error("useCallback() only valid inside an Articulated Function or a Custom Hook.")},useRef:function(t){if(n()){var[e]=i({current:t});return e}throw new Error("useRef() only valid inside an Articulated Function or a Custom Hook.")},useDeferred:function(){if(n()){const[t]=i(function(){let t,e;return{pr:new Promise((n,i)=>{t=n,e=i}),resolve:t,reject:e}}());return t}throw new Error("useDeferred() only valid inside an Articulated Function or a Custom Hook.")},useThrottle:function(t,e,...o){if(!t)throw new TypeError("useThrottle() requires a function argument");if(!e)throw new TypeError("useThrottle() requires a timer argument");if(n()){const[n]=i({fn:t,timer:e,lastExecute:0});return o.length>0&&1===o.length&&Array.isArray(o[0])&&(o=o[0]),n.throttledFn&&!a(n.guards,o)||(n.guards=o,n.timer=e,n.fn=t,n.throttledFn=function(...t){const{fn:e,timer:i,lastExecute:o}=n,a=Date.now();if(o+i<a)try{e.apply(this,t)}finally{n.lastExecute=a}}),n.throttledFn}throw new Error("useThrottle() only valid inside an Articulated Function or a Custom Hook.")}};function n(){if(e.length>0){let n,i=e[e.length-1];return t.has(i)||(n={nextStateSlotIdx:0,nextEffectIdx:0,nextMemoizationIdx:0,stateSlots:[],effects:[],cleanups:[],memoizations:[]},t.set(i,n)),t.get(i)}}function i(t){if(n())return o((function(t,e){return"function"==typeof e?e(t):e}),t);throw new Error("useState() only valid inside an Articulated Function or a Custom Hook.")}function o(t,e,...i){var o=n();if(o){if(!(o.nextStateSlotIdx in o.stateSlots)){let n=["function"==typeof e?e():e,function(e){n[0]=t(n[0],e)}];o.stateSlots[o.nextStateSlotIdx]=n,i.length>0&&o.stateSlots[o.nextStateSlotIdx][1](i[0])}return[...o.stateSlots[o.nextStateSlotIdx++]]}throw new Error("useReducer() only valid inside an Articulated Function or a Custom Hook.")}function a(t,e){if(void 0===t||void 0===e)return!0;if(t.length!==e.length)return!0;for(let[n,i]of t.entries())if(!Object.is(i,e[n]))return!0;return!1}function s(t,...e){e.length>0?1==e.length&&Array.isArray(e[0])&&(e=e[0]):e=[t];var i=n();if(i){i.nextMemoizationIdx in i.memoizations||(i.memoizations[i.nextMemoizationIdx]=[]);let n=i.memoizations[i.nextMemoizationIdx];if(a(n[1],e))try{n[0]=t()}finally{n[1]=e}return i.nextMemoizationIdx++,n[0]}throw new Error("useMemo() only valid inside an Articulated Function or a Custom Hook.")}},t.exports?t.exports=n():Object.assign(e,n())})).hooks;export{e as Component,L as ctx,S as emitter,W as hooks,k as htmel,_ as html,Q as onLoop,V as onScroll,a as render,H as storage,B as syncTabs,C as tweenState,$ as useAudio};
//# sourceMappingURL=index.esm.js.map
