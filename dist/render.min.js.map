{"version":3,"file":"render.min.js","sources":["../src/render.js"],"sourcesContent":[";(\"use strict\")\n\n// t = target\n// s = source\nconst domDiff = (t, s) => { // from https://codepen.io/tevko/pen/LzXjKE?editors=0010\n  const job = {\n    cfg: {\n      orig: t\n    },\n    // t = target\n    // s = source\n    replace(t, s = t) {\n      const v = document.createElement(\"template\")\n      v.innerHTML = s\n      const vHTML = v.content.firstElementChild\n      if (vHTML.nodeName !== t.nodeName) {\n        t.parentElement.replaceChild(vHTML, t)\n        return\n      }\n      this.loop(t, vHTML)\n    },\n    // tn = target Node\n    // sn = source Node\n    loop(tn, sn, tOrig) {\n      if (tn || sn) {\n        this.checkNew(tn, sn, tOrig)\n        if (\n          tn &&\n          sn &&\n          tn.nodeName !== sn.nodeName\n        ) {\n          this.checkNodeName(tn, sn)\n        } else if (\n          tn &&\n          sn &&\n          tn.nodeName === sn.nodeName\n        ) {\n          this.checkCtx(tn, sn)\n          tn.nodeType !== 3 &&\n            t.nodeType !== 8 &&\n            this.checkAttrs(tn, sn)\n        }\n      }\n      if (tn && sn) {\n        if (tn.childNodes && sn.childNodes) {\n          this.cfg.lengthDiff = [\n            ...t.childNodes,\n            ...sn.childNodes\n          ]\n        } else {\n          this.cfg.lengthDiff = null\n        }\n        Array.apply(null, this.cfg.lengthDiff).forEach(\n          (node, idx) => {\n            this.cfg.lengthDiff &&\n              this.loop(\n                tn.childNodes[idx],\n                sn.childNodes[idx],\n                tn,\n                sn\n              )\n          }\n        )\n      }\n    },\n    checkNodeName(tn, sn) {\n      const n = sn.cloneNode(true)\n      tn.parentElement.replaceChild(n, tn)\n    },\n    checkAttrs(tn, sn) {\n      const attrs = tn.attributes || []\n      const filteredAttrs = Object.keys(attrs).map(n => attrs[n])\n      const attrsNew = sn.attributes || []\n      const filteredAttrsNew = Object.keys(attrsNew).map(\n        n => attrsNew[n]\n      )\n      filteredAttrs.forEach(o => {\n        return sn.getAttribute(o.name) !== null\n          ? tn.setAttribute(o.name, sn.getAttribute(o.name))\n          : tn.removeAttribute(o.name)\n      })\n      filteredAttrsNew.forEach(a => {\n        return (\n          tn.getAttribute(a.name) !== sn.getAttribute(a.name) &&\n          tn.setAttribute(a.name, sn.getAttribute(a.name))\n        )\n      })\n    },\n    checkCtx(tn, sn) {\n      if (tn.nodeValue !== sn.nodeValue) {\n        tn.textContent = sn.textContent\n      }\n    },\n    checkNew(tn, sn, tParent = this.cfg.orig) {\n      if (sn && tn === undefined) {\n        const newNode = sn.cloneNode(true)\n        tParent.nodeType !== 3 &&\n          tParent.nodeType !== 8 &&\n          tParent.appendChild(newNode)\n      } else if (tn && sn === undefined) {\n        tn.parentElement.removeChild(tn)\n      }\n    }\n  }\n  // t = target\n  // s = source\n  Object.create(job).replace(t, s)\n}\n\nlet timeout;\n\nconst render = (view, sel) => {\n  if (!window) return v\n\n  const v = typeof view === 'function' ? view() : view\n  const c = document.querySelector(sel)\n\n  if (timeout) cancelAnimationFrame(timeout)\n\n  timeout = requestAnimationFrame(() => {\n    if (c && c.nodeName && v) {\n      domDiff(\n        c,\n        v.outerHTML ? v.outerHTML : `<${c.nodeName} ${c.id ? `id=\"${c.id}\"` : ''} ${c.className ? `class=\"${c.className}\"` : ''}>${v}</${c.nodeName}>`\n      )\n      //console.log('diffed DOM')\n    }\n  });\n\n  return c\n}\n\nexport default render;\n"],"names":["domDiff","t","s","job","cfg","orig","[object Object]","v","document","createElement","innerHTML","vHTML","content","firstElementChild","nodeName","this","loop","parentElement","replaceChild","tn","sn","tOrig","checkNew","checkNodeName","checkCtx","nodeType","checkAttrs","childNodes","lengthDiff","Array","apply","forEach","node","idx","n","cloneNode","attrs","attributes","filteredAttrs","Object","keys","map","attrsNew","filteredAttrsNew","o","getAttribute","name","setAttribute","removeAttribute","a","nodeValue","textContent","tParent","undefined","newNode","appendChild","removeChild","create","replace","timeout","view","sel","window","c","querySelector","cancelAnimationFrame","requestAnimationFrame","outerHTML","id","className"],"mappings":"uOAIA,MAAMA,EAAU,CAACC,EAAGC,KAClB,MAAMC,EAAM,CACVC,IAAK,CACHC,KAAMJ,GAIRK,QAAQL,EAAGC,EAAID,GACb,MAAMM,EAAIC,SAASC,cAAc,YACjCF,EAAEG,UAAYR,EACd,MAAMS,EAAQJ,EAAEK,QAAQC,kBACpBF,EAAMG,WAAab,EAAEa,SAIzBC,KAAKC,KAAKf,EAAGU,GAHXV,EAAEgB,cAAcC,aAAaP,EAAOV,IAOxCK,KAAKa,EAAIC,EAAIC,IACPF,GAAMC,KACRL,KAAKO,SAASH,EAAIC,EAAIC,GAEpBF,GACAC,GACAD,EAAGL,WAAaM,EAAGN,SAEnBC,KAAKQ,cAAcJ,EAAIC,GAEvBD,GACAC,GACAD,EAAGL,WAAaM,EAAGN,WAEnBC,KAAKS,SAASL,EAAIC,GACF,IAAhBD,EAAGM,UACc,IAAfxB,EAAEwB,UACFV,KAAKW,WAAWP,EAAIC,KAGtBD,GAAMC,IACJD,EAAGQ,YAAcP,EAAGO,WACtBZ,KAAKX,IAAIwB,WAAa,IACjB3B,EAAE0B,cACFP,EAAGO,YAGRZ,KAAKX,IAAIwB,WAAa,KAExBC,MAAMC,MAAM,KAAMf,KAAKX,IAAIwB,YAAYG,QACrC,CAACC,EAAMC,KACLlB,KAAKX,IAAIwB,YACPb,KAAKC,KACHG,EAAGQ,WAAWM,GACdb,EAAGO,WAAWM,GACdd,EACAC,OAMZd,cAAca,EAAIC,GAChB,MAAMc,EAAId,EAAGe,WAAU,GACvBhB,EAAGF,cAAcC,aAAagB,EAAGf,IAEnCb,WAAWa,EAAIC,GACb,MAAMgB,EAAQjB,EAAGkB,YAAc,GACzBC,EAAgBC,OAAOC,KAAKJ,GAAOK,IAAIP,GAAKE,EAAMF,IAClDQ,EAAWtB,EAAGiB,YAAc,GAC5BM,EAAmBJ,OAAOC,KAAKE,GAAUD,IAC7CP,GAAKQ,EAASR,IAEhBI,EAAcP,QAAQa,GACe,OAA5BxB,EAAGyB,aAAaD,EAAEE,MACrB3B,EAAG4B,aAAaH,EAAEE,KAAM1B,EAAGyB,aAAaD,EAAEE,OAC1C3B,EAAG6B,gBAAgBJ,EAAEE,OAE3BH,EAAiBZ,QAAQkB,GAErB9B,EAAG0B,aAAaI,EAAEH,QAAU1B,EAAGyB,aAAaI,EAAEH,OAC9C3B,EAAG4B,aAAaE,EAAEH,KAAM1B,EAAGyB,aAAaI,EAAEH,SAIhDxC,SAASa,EAAIC,GACPD,EAAG+B,YAAc9B,EAAG8B,YACtB/B,EAAGgC,YAAc/B,EAAG+B,cAGxB7C,SAASa,EAAIC,EAAIgC,EAAUrC,KAAKX,IAAIC,MAClC,GAAIe,QAAaiC,IAAPlC,EAAkB,CAC1B,MAAMmC,EAAUlC,EAAGe,WAAU,GACR,IAArBiB,EAAQ3B,UACe,IAArB2B,EAAQ3B,UACR2B,EAAQG,YAAYD,QACbnC,QAAakC,IAAPjC,GACfD,EAAGF,cAAcuC,YAAYrC,KAMnCoB,OAAOkB,OAAOtD,GAAKuD,QAAQzD,EAAGC,IAGhC,IAAIyD,QAEW,CAACC,EAAMC,KACpB,IAAKC,OAAQ,OAAOvD,EAEpB,MAAMA,EAAoB,mBAATqD,EAAsBA,IAASA,EAC1CG,EAAIvD,SAASwD,cAAcH,GAcjC,OAZIF,GAASM,qBAAqBN,GAElCA,EAAUO,sBAAsB,KAC1BH,GAAKA,EAAEjD,UAAYP,GACrBP,EACE+D,EACAxD,EAAE4D,UAAY5D,EAAE4D,UAAY,IAAIJ,EAAEjD,YAAYiD,EAAEK,GAAK,OAAOL,EAAEK,MAAQ,MAAML,EAAEM,UAAY,UAAUN,EAAEM,aAAe,MAAM9D,MAAMwD,EAAEjD,eAMlIiD"}