!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Ctx=e()}(this,(function(){"use strict";const t="arc arcTo beginPath bezierCurveTo clearRect clip closePath createImageData createLinearGradient createRadialGradient createPattern drawFocusRing drawImage fill fillRect fillText getImageData isPointInPath lineTo measureText moveTo putImageData quadraticCurveTo rect restore rotate save scale setTransform stroke strokeRect strokeText transform translate".split(" "),e="canvas fillStyle font globalAlpha globalCompositeOperation lineCap lineJoin lineWidth miterLimit shadowOffsetX shadowOffsetY shadowBlur shadowColor strokeStyle textAlign textBaseline".split(" ");function s(t,e,i){return function(){return t.apply(e,arguments)||i}}function o(t,e,i){return function(s){return void 0===s?e[t]:(e[t]=s,i)}}const h=window&&window.devicePixelRatio||1,n=Math.PI,a=2*n,r=n/2,c=180/n,l=n/180;function f(t,e){let i=document.createElement("a"),s=URL.createObjectURL(t),o=e||"canvas-"+(new Date).valueOf();i.target="_blank",i.href=s,i.download=o,i.click(),window.URL.revokeObjectURL(s)}const u={clear:function(t){!0===t&&this.setTransform(1,0,0,1,0,0),this.clearRect(0,0,this.canvas.width*h,this.canvas.height*h)},fullscreen:function(){document.fullscreenElement?document.exitFullscreen():this.canvas.requestFullscreen()},isClean:function(){try{this.getImageData(0,0,1,1);return!0}catch(t){return!1}},size:function(t,e,i){this.w===t&&this.h===e||(this.w=t||e*i,this.h=e||t*i,this.canvas.width=this.w*h,this.canvas.height=this.h*h,this.canvas.style.width=this.w+"px",this.canvas.style.height=this.h+"px",this.canvas.style.objectFit=i?"contain":null,"2d"===this.contextType&&1!==h&&this.scale(h,h))},camera:function(t=0,e=0,i=1,s=0){this.resetTransform(),this.translate(t,e),this.rotate(s*l),this.scale(i,i),this.translate(-t,-e)},chromaKey:function(t=150,e=[0,255,0]){const i=t>250?250:t,s=this.getImageData(0,0,this.canvas.width,this.canvas.height),o=s.data;let h;if(e[1]>e[0]&&e[1]>e[2])for(let t=0,e=o.length;t<e;t+=4)o[t+1]>50&&o[t+1]>o[t]&&o[t+1]>o[t+2]&&(o[t+3]=0);else for(let t=0,s=o.length;t<s;t+=4)h=Math.abs(e[0]-o[t+0])+Math.abs(e[1]-o[t+1])+Math.abs(e[2]-o[t+2]),h<i&&(o[t+3]=h*h/i);this.putImageData(s,0,0)},line:function(t,e,i,s,o=[]){this.beginPath(),this.save(),this.setLineDash(o),this.moveTo(t,e),this.lineTo(i,s),this.closePath(),this.fill(),this.stroke(),this.restore()},circle:function(t,e,i,s=360,o){this.beginPath(),this.arc(t,e,i,0,s*l,o),this.lineTo(t,e),this.closePath()},fillCircle:function(t,e,i,s){u.circle.apply(this,[t,e,i,s]),this.fill()},strokeCircle:function(t,e,i,s){u.circle.apply(this,[t,e,i,s]),this.stroke()},ellipse:function(t,e,i,s){let o,h,n,a,r,c,l;o=.5522848,h=i/2*.5522848,n=s/2*.5522848,a=t+i,c=e+s,r=t+i/2,l=e+s/2,this.moveTo(t,l),this.bezierCurveTo(t,l-n,r-h,e,r,e),this.bezierCurveTo(r+h,e,a,l-n,a,l),this.bezierCurveTo(a,l+n,r+h,c,r,c),this.bezierCurveTo(r-h,c,t,l+n,t,l)},fillEllipse:function(t,e,i,s){this.beginPath(),u.ellipse.apply(this,[t,e,i,s]),this.closePath(),this.fill()},strokeEllipse:function(t,e,i,s){this.beginPath(),u.ellipse.apply(this,[t,e,i,s]),this.closePath(),this.stroke()},ring:function(t,e,i,s){this.beginPath(),this.arc(t,e,i,0,a,!1),this.moveTo(s,0),this.arc(t,e,s,a,0,!0),this.closePath()},fillRing:function(t,e,i,s){u.ring.apply(this,[t,e,i,s]),this.fill()},strokeRing:function(t,e,i,s){u.ring.apply(this,[t,e,i,s]),this.stroke()},gradientCircle:function(t,e,i,s,o=0,h=0,n){const a=this.createRadialGradient(t+o,e+h,s,t+o,e+h,i);for(let t=0;t<n.length;t++)a.addColorStop(n[t][0],n[t][1]);this.fillStyle=a,u.circle.apply(this,[t,e,s]),this.fill(),this.closePath()},gradientRect:function(t,e,i,s,o,h=!0){if(o){const n=h?this.createLinearGradient(t,e,t,e+s):this.createLinearGradient(t,e,t+i,e);for(let t=0;t<o.length;t++)n.addColorStop(o[t][0],o[t][1]);this.fillStyle=n,this.fillRect(t,e,i,s),this.closePath()}},roundedRect:function(t,e,i,s,o){this.moveTo(t+o,e),this.arcTo(t+i,e,t+i,e+o,o),this.arcTo(t+i,e+s,t+i-o,e+s,o),this.arcTo(t,e+s,t,e+s-o,o),this.arcTo(t,e,t+o,e,o),this.closePath()},fillRoundedRect:function(t,e,i,s,o){this.beginPath(),u.roundedRect.apply(this,[t,e,i,s,o]),this.fill()},strokeRoundedRect:function(t,e,i,s,o){this.beginPath(),u.roundedRect.apply(this,[t,e,i,s,o]),this.stroke()},polygon:function(t,e=[],i=!0){this.beginPath(),i&&this.save(),this.setLineDash(e);const s=t[0][0],o=t[0][1];this.moveTo(s,o),t.shift(),t.forEach(t=>this.lineTo(t[0],t[1])),this.closePath(),i&&this.restore()},fillPolygon:function(t,e=[]){u.polyshape.apply(this,[t,e,!1]),this.fill(),this.restore()},strokePolygon:function(t,e=[]){u.polyshape.apply(this,[t,e,!1]),this.stroke(),this.restore()},polyshape:function(t,e,i,s,o){const h={x:t,y:e},r=s||6,c=o||0;this.translate(h.x,h.y),this.rotate(c*l),this.beginPath(),this.moveTo(i,0);for(var f=0;f<=a;f+=n/(r/2))this.lineTo(i*Math.cos(f),i*Math.sin(f));this.closePath(),this.rotate(-c*l),this.translate(-h.x,-h.y)},fillPolyshape:function(t,e,i,s,o){u.polyshape.apply(this,[t,e,i,s,o]),this.fill()},strokePolyshape:function(t,e,i,s,o){u.polyshape.apply(this,[t,e,i,s,o]),this.stroke()},star:function(t,e,i,s,o){const h={x:t,y:e},r=2*(s||5),c=-90-(o||0);this.translate(h.x,h.y),this.rotate(c*l),this.beginPath(),this.moveTo(i,0);let f=2;for(var u=0;u<=a;u+=n/(r/2))f=1==f?2:1,this.lineTo(i/f*Math.cos(u),i/f*Math.sin(u));this.closePath(),this.rotate(-c*l),this.translate(-h.x,-h.y)},fillStar:function(t,e,i,s,o){u.star.apply(this,[t,e,i,s,o]),this.fill()},strokeStar:function(t,e,i,s,o){u.star.apply(this,[t,e,i,s,o]),this.stroke()},square:function(t,e,i){this.beginPath(),this.rect(t,e,i,i),this.closePath()},triangle:function(t,e,i,s){u.polyshape.apply(this,[t,e,i,3,s||-90])},fillTriangle:function(t,e,i,s){u.polyshape.apply(this,[t,e,i,3,s||-90]),this.fill()},strokeTriangle:function(t,e,i,s){u.polyshape.apply(this,[t,e,i,3,s||-90]),this.stroke()},curve:function(t,e,i,s){let o;e="number"==typeof e?e:.5,i=i||20;let h,n=[],a=t.length,r=new Float32Array(4*(i+2)),c=4;for(o=t.slice(0),s?(o.unshift(t[a-1]),o.unshift(t[a-2]),o.push(t[0],t[1])):(o.unshift(t[1]),o.unshift(t[0]),o.push(t[a-2],t[a-1])),r[0]=1,h=1;h<i;h++){let t=h/i,e=t*t,s=e*t,o=2*s,n=3*e;r[c++]=o-n+1,r[c++]=n-o,r[c++]=s-2*e+t,r[c++]=s-e}function l(t,s,o){for(let h=2;h<o;h+=2){let o=t[h],a=t[h+1],r=t[h+2],c=t[h+3],l=(r-t[h-2])*e,f=(c-t[h-1])*e,u=(t[h+4]-o)*e,d=(t[h+5]-a)*e;for(let t=0;t<=i;t++){const e=4*t;n.push(s[e]*o+s[e+1]*r+s[e+2]*l+s[e+3]*u,s[e]*a+s[e+1]*c+s[e+2]*f+s[e+3]*d)}}}for(r[++c]=1,l(o,r,a),s&&(o=[],o.push(t[a-4],t[a-3],t[a-2],t[a-1]),o.push(t[0],t[1],t[2],t[3]),l(o,r,4)),h=0,a=n.length;h<a;h+=2)this.lineTo(n[h],n[h+1]);return n},drawGridBox(t,e,i,s,o,h=.1,n="#444"){this.save(),this.lineWidth=h,this.strokeStyle=n,this.moveTo(t,e),this.lineTo(t+i,e),this.lineTo(t+i,e+s),this.lineTo(t,e+s),this.lineTo(t,e);for(let h=1;h<i/o;h++)this.moveTo(t+o*h,e),this.lineTo(t+o*h,e+s);for(let h=1;h<s/o;h++)this.moveTo(t,e+o*h),this.lineTo(t+i,e+o*h);this.stroke(),this.closePath(),this.restore()},drawGrid(t,e=.1,i="#444"){u.drawGridBox.apply(this,[0,0,this.canvas.width,this.canvas.height,t,e,i])},checkerboard:function(t,e,i,s,o,h,n){const a=i/o|0,r=s/o|0;let c;this.save(),this.rect(t,e,i,s);for(var l=0;l<=a;l++)for(var f=0;f<=r;f++)c=f%2?l%2?h:n:l%2?n:h,this.fillStyle=c,this.fillRect(t+l*o,e+f*o,o,o);this.restore()},cacheImg:function(t,e,i,s,o,h,n,a,r){return this.cache[t]||(this.cache[t]=new Image,this.cache[t].onload=()=>(this.cache[t].width=s,this.cache[t].height=o,h?this.drawImage(this.cache[t],e,i,s,o,h,n,a,r):this.drawImage(this.cache[t],e,i,s,o)),this.cache[t].crossOrigin="anonymous"),this.cache[t]},drawImg:function(t,e,i,s,o,h,n,a,r){return t.outerHTML?h?this.drawImage(t,e,i,s,o,h,n,a,r):this.drawImage(t,e,i,s,o):(this.cache||(this.cache={}),this.cache[t]&&this.cache[t].src?h?this.drawImage(this.cache[t],e,i,s,o,h,n,a,r):this.drawImage(this.cache[t],e,i,s,o):void(u.cacheImg.apply(this,[t,e,i,s,o,h,n,a,r]).src=t.includes("<svg")?"data:image/svg+xml; charset=utf8,"+encodeURIComponent(t):t))},setStyle:function(t){for(i in t)this[i]=t[i]},angleFromPoints:function(t,e,i,s){return Math.atan2(s-i,e-t)},angleToTarget:function(t,e,i,s){return Math.atan2(s-e,i-t)+r},clamp:function(t,e,i){return Math.min(Math.max(e,t),i)},distance:function(t,e,i,s){return Math.sqrt(Math.pow(t-e,2)+Math.pow(i-s,2))},seededRandom:function(t){for(var e=0,i=2166136261;e<t.length;e++)i=Math.imul(i^t.charCodeAt(e),16777619);i+=i<<13,i^=i>>>7,i+=i<<3,i^=i>>>17;let s=(i+=i<<5)>>>0,o=()=>(2**31-1&(s=Math.imul(48271,s)))/2**31;return o(),o},random:function(t,e,i){return i?Math.random()*(e-t)+t:Math.floor(Math.random()*(e-t+1))+t},randomFrom(t){return u.random.apply(this,[1,t.length])},rotateAt:function(t,e,i){this.translate(t,e),this.rotate(i*l),this.translate(-t,-e)},toRad:function(t){return t*l},toDeg:function(t){return t*c}},d=Object.keys(u);return window.Ctx=function(i,h){let n,a,r=t.length;const c=function(){let t=null,e=["video/webm","video/webm;codecs=vp9","video/vp8","video/webm;codecs=vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mp4","video/mpeg"];for(let i in e)if(MediaRecorder.isTypeSupported(e[i])){t=e[i];break}return t}();for(this.context=i;r--;)n=t[r],this[n]=s(i[n],i,this);for(r=d.length;r--;)n=d[r],this[n]=s(u[n],i,this);for(r=e.length;r--;)n=e[r],this[n]=o(n,i,this);this.canvas=i.canvas,this.image={saveAs:function(t){this.canvas.toBlob(e=>f(e,t))},toElement:function(t){const e=new Image,{w:i,h:s}=this;e.onload=function(){e.width=i,e.height=s,t(e)},e.crossOrigin="anonymous",e.src=this.canvas.toDataURL("image/png")}},this.video={record:(t,e=c,i=128e3,s=25e5)=>{if(!0===this.isRecording)return!0;const o=t>0&&t<=60?t:24;a=[];const h={audioBitsPerSecond:i,videoBitsPerSecond:s,mimeType:e},n=this.canvas.captureStream(o);this.rec=new MediaRecorder(n,h),this.rec.ondataavailable=function(t){a.push(t.data)},this.rec.onstop=t=>(this.videoBlob=new Blob(a,{type:e}),a=[],this.isRecording=!1,this.rec=null,this.videoBlob),this.rec.onstart=t=>this.isRecording=!0,this.rec.onresume=t=>this.isRecording=!0,this.rec.onpause=t=>{this.isRecording=!1,this.videoBlob=new Blob(a,{type:e})},this.rec.start()},stop:()=>{if(!this.isRecording)throw Error("No video is recording");return this.rec.stop()},saveAs:t=>{setTimeout(()=>{if(this.isRecording&&this.rec.stop(),!this.videoBlob)throw Error("No video to save");f(this.videoBlob,t),this.videoBlob=null},64)},toElement:t=>{setTimeout(()=>{if(!this.videoBlob)throw Error("No video to export");const e=document.createElement("video"),{w:i,h:s}=this;e.width=i,e.height=s,e.crossOrigin="anonymous",e.src=URL.createObjectURL(this.videoBlob),e.load(),t(e)},64)}}},Ctx}));
//# sourceMappingURL=ctx.min.js.map
