!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).Ctx=i()}(this,(function(){"use strict";const t="arc arcTo beginPath bezierCurveTo clearRect clip closePath createImageData createLinearGradient createRadialGradient createPattern drawFocusRing drawImage fill fillRect fillText getImageData isPointInPath lineTo measureText moveTo putImageData quadraticCurveTo rect restore rotate save scale setTransform stroke strokeRect strokeText transform translate".split(" "),e="canvas fillStyle font globalAlpha globalCompositeOperation lineCap lineJoin lineWidth miterLimit shadowOffsetX shadowOffsetY shadowBlur shadowColor strokeStyle textAlign textBaseline".split(" ");function s(t,i,e){return function(){return t.apply(i,arguments)||e}}function h(t,i,e){return function(s){return void 0===s?i[t]:(i[t]=s,e)}}const o="undefined"!=typeof window&&window&&window.devicePixelRatio||1,n=Math.PI,a=2*n,r=n/2,c=180/n,l=n/180;function u(t,i){let e=document.createElement("a"),s=URL.createObjectURL(t),h=i||"canvas-"+(new Date).valueOf();e.target="_blank",e.href=s,e.download=h,e.click(),window.URL.revokeObjectURL(s)}const d=function(t,i,e,s,h,o,n,a){switch(t.save(),t.beginPath(),t.moveTo(i,e),t.lineTo(s,h),t.lineTo(o,n),a){case 0:t.beginPath(),t.moveTo(i,e),t.lineTo(s,h),t.lineTo(o,n),t.lineTo(i,e),t.fill();break;case 1:const a=(i+s+o)/3,r=(e+h+n)/3;t.quadraticCurveTo(a,r,i,e),t.fill()}t.restore()},f={clear:function(t){!0===t&&this.setTransform(1,0,0,1,0,0),this.clearRect(0,0,this.canvas.width*o,this.canvas.height*o)},fullscreen:function(){document.fullscreenElement?document.exitFullscreen():this.canvas.requestFullscreen()},isClean:function(){try{this.getImageData(0,0,1,1);return!0}catch(t){return!1}},size:function(t,i,e){this.w===t&&this.h===i||(this.w=t||i*e,this.h=i||t*e,this.canvas.width=this.w*o,this.canvas.height=this.h*o,this.canvas.style.width=this.w+"px",this.canvas.style.height=this.h+"px",this.canvas.style.objectFit=e?"contain":null,"2d"===this.contextType&&1!==o&&this.scale(o,o))},camera:function(t=0,i=0,e=1,s=0){this.resetTransform(),this.translate(t,i),this.rotate(s*l),this.scale(e,e),this.translate(-t,-i)},chromaKey:function(t=150,i=[0,255,0]){const e=t>250?250:t,s=this.getImageData(0,0,this.canvas.width,this.canvas.height),h=s.data;let o;if(i[1]>i[0]&&i[1]>i[2])for(let t=0,i=h.length;t<i;t+=4)h[t+1]>50&&h[t+1]>h[t]&&h[t+1]>h[t+2]&&(h[t+3]=0);else for(let t=0,s=h.length;t<s;t+=4)o=Math.abs(i[0]-h[t+0])+Math.abs(i[1]-h[t+1])+Math.abs(i[2]-h[t+2]),o<e&&(h[t+3]=o*o/e);this.putImageData(s,0,0)},arcArrow:function(t,i,e,s,h,o,n=0,a=10,r=1,u=Math.PI/8){let d,p,g,v,m;s*=l,h*=l,u*=l,this.save(),this.lineWidth=this.lineWidth>2?2:this.lineWidth,this.beginPath(),this.arc(t,i,e,s,h,o),this.stroke(),this.strokeStyle="rgba(0,0,0,0)",1&r&&(d=Math.cos(s)*e+t,p=Math.sin(s)*e+i,g=Math.atan2(t-d,p-i),o?(v=d+10*Math.cos(g),m=p+10*Math.sin(g)):(v=d-10*Math.cos(g),m=p-10*Math.sin(g)),f.arrow.apply(this,[d,p,v,m,n,a,2,u*c])),2&r&&(d=Math.cos(h)*e+t,p=Math.sin(h)*e+i,g=Math.atan2(t-d,p-i),o?(v=d-10*Math.cos(g),m=p-10*Math.sin(g)):(v=d+10*Math.cos(g),m=p+10*Math.sin(g)),f.arrow.apply(this,[d,p,v,m,n,a,2,u*c])),this.restore()},arrow:function(t,i,e,s,h=1,o=10,n=1,a=Math.PI/8){a*=l;const r=Math.sqrt((e-t)*(e-t)+(s-i)*(s-i)),c=(r-o/3)/r;let u,f,p,g;1===n?(p=t,g=i,u=Math.round(t+(e-t)*c),f=Math.round(i+(s-i)*c)):(p=t+(e-t)*(1-c),g=i+(s-i)*(1-c),u=e,f=s),this.lineWidth=this.lineWidth>2?2:this.lineWidth,this.beginPath(),this.moveTo(p,g),this.lineTo(u,f),this.stroke();const v=Math.atan2(s-i,e-t),m=Math.abs(o/Math.cos(a));let y,w,T,M,b,P;1&n&&(y=v+Math.PI+a,w=e+Math.cos(y)*m,T=s+Math.sin(y)*m,M=v+Math.PI-a,b=e+Math.cos(M)*m,P=s+Math.sin(M)*m,d(this,w,T,e,s,b,P,h)),2&n&&(y=v+a,w=t+Math.cos(y)*m,T=i+Math.sin(y)*m,M=v-a,b=t+Math.cos(M)*m,P=i+Math.sin(M)*m,d(this,w,T,t,i,b,P,h))},circle:function(t,i,e,s=360,h){this.beginPath(),this.arc(t,i,e,0,s*l,h),this.lineTo(t,i),this.closePath()},curve:function(t,i,e,s){let h;i="number"==typeof i?i:.5,e=e||20;let o,n=[],a=t.length,r=new Float32Array(4*(e+2)),c=4;for(h=t.slice(0),s?(h.unshift(t[a-1]),h.unshift(t[a-2]),h.push(t[0],t[1])):(h.unshift(t[1]),h.unshift(t[0]),h.push(t[a-2],t[a-1])),r[0]=1,o=1;o<e;o++){let t=o/e,i=t*t,s=i*t,h=2*s,n=3*i;r[c++]=h-n+1,r[c++]=n-h,r[c++]=s-2*i+t,r[c++]=s-i}function l(t,s,h){for(let o=2;o<h;o+=2){let h=t[o],a=t[o+1],r=t[o+2],c=t[o+3],l=(r-t[o-2])*i,u=(c-t[o-1])*i,d=(t[o+4]-h)*i,f=(t[o+5]-a)*i;for(let t=0;t<=e;t++){const i=4*t;n.push(s[i]*h+s[i+1]*r+s[i+2]*l+s[i+3]*d,s[i]*a+s[i+1]*c+s[i+2]*u+s[i+3]*f)}}}for(r[++c]=1,l(h,r,a),s&&(h=[],h.push(t[a-4],t[a-3],t[a-2],t[a-1]),h.push(t[0],t[1],t[2],t[3]),l(h,r,4)),o=0,a=n.length;o<a;o+=2)this.lineTo(n[o],n[o+1]);return n},ellipse:function(t,i,e,s){let h,o,n,a,r,c,l;h=.5522848,o=e/2*.5522848,n=s/2*.5522848,a=t+e,c=i+s,r=t+e/2,l=i+s/2,this.moveTo(t,l),this.bezierCurveTo(t,l-n,r-o,i,r,i),this.bezierCurveTo(r+o,i,a,l-n,a,l),this.bezierCurveTo(a,l+n,r+o,c,r,c),this.bezierCurveTo(r-o,c,t,l+n,t,l)},fillCircle:function(t,i,e,s){f.circle.apply(this,[t,i,e,s]),this.fill()},fillEllipse:function(t,i,e,s){this.beginPath(),f.ellipse.apply(this,[t,i,e,s]),this.closePath(),this.fill()},fillPolygon:function(t,i=[]){f.polyshape.apply(this,[t,i,!1]),this.fill(),this.restore()},fillPolyshape:function(t,i,e,s,h){f.polyshape.apply(this,[t,i,e,s,h]),this.fill()},fillRing:function(t,i,e,s){f.ring.apply(this,[t,i,e,s]),this.fill()},fillRoundedRect:function(t,i,e,s,h){this.beginPath(),f.roundedRect.apply(this,[t,i,e,s,h]),this.fill()},fillStar:function(t,i,e,s,h){f.star.apply(this,[t,i,e,s,h]),this.fill()},fillTriangle:function(t,i,e,s){f.polyshape.apply(this,[t,i,e,3,s||-90]),this.fill()},gradientCircle:function(t,i,e,s,h=0,o=0,n){const a=this.createRadialGradient(t+h,i+o,s,t+h,i+o,e);for(let t=0;t<n.length;t++)a.addColorStop(n[t][0],n[t][1]);this.fillStyle=a,f.circle.apply(this,[t,i,s]),this.fill(),this.closePath()},gradientRect:function(t,i,e,s,h,o=!0){if(h){const n=o?this.createLinearGradient(t,i,t,i+s):this.createLinearGradient(t,i,t+e,i);for(let t=0;t<h.length;t++)n.addColorStop(h[t][0],h[t][1]);this.fillStyle=n,this.fillRect(t,i,e,s),this.closePath()}},line:function(t,i,e,s,h=[]){this.beginPath(),this.save(),this.setLineDash(h),this.moveTo(t,i),this.lineTo(e,s),this.closePath(),this.fill(),this.stroke(),this.restore()},polygon:function(t,i=[],e=!0){this.beginPath(),e&&this.save(),this.setLineDash(i);const s=t[0][0],h=t[0][1];this.moveTo(s,h),t.shift(),t.forEach(t=>this.lineTo(t[0],t[1])),this.closePath(),e&&this.restore()},polyshape:function(t,i,e,s,h){const o={x:t,y:i},r=s||6,c=h||0;this.translate(o.x,o.y),this.rotate(c*l),this.beginPath(),this.moveTo(e,0);for(var u=0;u<=a;u+=n/(r/2))this.lineTo(e*Math.cos(u),e*Math.sin(u));this.closePath(),this.rotate(-c*l),this.translate(-o.x,-o.y)},ring:function(t,i,e,s){this.beginPath(),this.arc(t,i,e,0,a,!1),this.moveTo(s,0),this.arc(t,i,s,a,0,!0),this.closePath()},roundedRect:function(t,i,e,s,h){this.moveTo(t+h,i),this.arcTo(t+e,i,t+e,i+h,h),this.arcTo(t+e,i+s,t+e-h,i+s,h),this.arcTo(t,i+s,t,i+s-h,h),this.arcTo(t,i,t+h,i,h),this.closePath()},spiral:function(t,i,e,s,h,o,n){let a=e/(s+1),r=0,c=a/Math.PI*2*r;h*=l,this.save(),this.lineWidth=o,this.strokeStyle=n;let u=t,d=i;for(t+=c*Math.cos(c-h),i+=c*Math.sin(c-h),this.beginPath();r<s;)r++,c=a/Math.PI*2*r,this.moveTo(t,i),t=u+c*Math.cos(c-h),i=d+c*Math.sin(c-h),this.lineTo(t,i);this.stroke(),this.closePath(),this.restore()},square:function(t,i,e){this.beginPath(),this.rect(t,i,e,e),this.closePath()},star:function(t,i,e,s,h){const o={x:t,y:i},r=2*(s||5),c=-90-(h||0);this.translate(o.x,o.y),this.rotate(c*l),this.beginPath(),this.moveTo(e,0);let u=2;for(var d=0;d<=a;d+=n/(r/2))u=1==u?2:1,this.lineTo(e/u*Math.cos(d),e/u*Math.sin(d));this.closePath(),this.rotate(-c*l),this.translate(-o.x,-o.y)},strokeCircle:function(t,i,e,s){f.circle.apply(this,[t,i,e,s]),this.stroke()},strokeEllipse:function(t,i,e,s){this.beginPath(),f.ellipse.apply(this,[t,i,e,s]),this.closePath(),this.stroke()},strokeRing:function(t,i,e,s){f.ring.apply(this,[t,i,e,s]),this.stroke()},strokeRoundedRect:function(t,i,e,s,h){this.beginPath(),f.roundedRect.apply(this,[t,i,e,s,h]),this.stroke()},strokePolygon:function(t,i=[]){f.polyshape.apply(this,[t,i,!1]),this.stroke(),this.restore()},strokePolyshape:function(t,i,e,s,h){f.polyshape.apply(this,[t,i,e,s,h]),this.stroke()},strokeStar:function(t,i,e,s,h){f.star.apply(this,[t,i,e,s,h]),this.stroke()},strokeTriangle:function(t,i,e,s){f.polyshape.apply(this,[t,i,e,3,s||-90]),this.stroke()},triangle:function(t,i,e,s){f.polyshape.apply(this,[t,i,e,3,s||-90])},checkerboard:function(t,i,e,s,h,o,n){const a=e/h|0,r=s/h|0;let c;this.save(),this.rect(t,i,e,s);for(var l=0;l<=a;l++)for(var u=0;u<=r;u++)c=u%2?l%2?o:n:l%2?n:o,this.fillStyle=c,this.fillRect(t+l*h,i+u*h,h,h);this.restore()},drawGrid(t,i=.1,e="#444"){f.drawGridBox.apply(this,[0,0,this.canvas.width,this.canvas.height,t,i,e])},drawGridBox(t,i,e,s,h,o=.1,n="#444"){this.save(),this.lineWidth=o,this.strokeStyle=n,this.moveTo(t,i),this.lineTo(t+e,i),this.lineTo(t+e,i+s),this.lineTo(t,i+s),this.lineTo(t,i);for(let o=1;o<e/h;o++)this.moveTo(t+h*o,i),this.lineTo(t+h*o,i+s);for(let o=1;o<s/h;o++)this.moveTo(t,i+h*o),this.lineTo(t+e,i+h*o);this.stroke(),this.closePath(),this.restore()},cacheImg:function(t,i,e,s,h,o,n,a,r){return this.cache[t]||(this.cache[t]=new Image,this.cache[t].onload=()=>(this.cache[t].width=s,this.cache[t].height=h,o?this.drawImage(this.cache[t],i,e,s,h,o,n,a,r):this.drawImage(this.cache[t],i,e,s,h)),this.cache[t].crossOrigin="anonymous"),this.cache[t]},drawImg:function(t,i,e,s,h,o,n,a,r){return t.outerHTML?o?this.drawImage(t,i,e,s,h,o,n,a,r):this.drawImage(t,i,e,s,h):(this.cache||(this.cache={}),this.cache[t]&&this.cache[t].src?o?this.drawImage(this.cache[t],i,e,s,h,o,n,a,r):this.drawImage(this.cache[t],i,e,s,h):void(f.cacheImg.apply(this,[t,i,e,s,h,o,n,a,r]).src=t.includes("<svg")?"data:image/svg+xml; charset=utf8,"+encodeURIComponent(t):t))},setStyle:function(t){for(i in t)this[i]=t[i]},angleFromPoints:function(t,i,e,s){return Math.atan2(s-e,i-t)},angleToTarget:function(t,i,e,s){return Math.atan2(s-i,e-t)+r},clamp:function(t,i,e){return Math.min(Math.max(i,t),e)},distance:function(t,i,e,s){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-s,2))},inverseLerp:function(t,i,e){return(e-t)/(i-t)},lerp:function(t,i,e){return t+e*(i-t)},seededRandom:function(t){for(var i=0,e=2166136261;i<t.length;i++)e=Math.imul(e^t.charCodeAt(i),16777619);e+=e<<13,e^=e>>>7,e+=e<<3,e^=e>>>17;let s=(e+=e<<5)>>>0,h=()=>(2**31-1&(s=Math.imul(48271,s)))/2**31;return h(),h},random:function(t,i,e){return e?Math.random()*(i-t)+t:Math.floor(Math.random()*(i-t+1))+t},randomFrom(t){return f.random.apply(this,[1,t.length])},rotateAt:function(t,i,e){this.translate(t,i),this.rotate(e*l),this.translate(-t,-i)},toRad:function(t){return t*l},toDeg:function(t){return t*c}},p=Object.keys(f);return function(i,o){let n,a,r=t.length;const c=!!window.MediaRecorder&&function(){let t=null,i=["video/webm","video/webm;codecs=vp9","video/vp8","video/webm;codecs=vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mp4","video/mpeg"];for(let e in i)if(MediaRecorder.isTypeSupported(i[e])){t=i[e];break}return t}();for(this.context=i;r--;)n=t[r],this[n]=s(i[n],i,this);for(r=p.length;r--;)n=p[r],this[n]=s(f[n],i,this);for(r=e.length;r--;)n=e[r],this[n]=h(n,i,this);this.canvas=i.canvas,this.image={saveAs:function(t){this.canvas.toBlob(i=>u(i,t))},toElement:function(t){const i=new Image,{w:e,h:s}=this;i.onload=function(){i.width=e,i.height=s,t(i)},i.crossOrigin="anonymous",i.src=this.canvas.toDataURL("image/png")}},this.video={record:(t,i=c,e=128e3,s=25e5)=>{if(!window.MediaRecorder)throw Error("Video recording not supported");if(!0===this.isRecording)return!0;const h=t>0&&t<=60?t:60;a=[];const o={audioBitsPerSecond:e,videoBitsPerSecond:s,mimeType:i},n=this.canvas.captureStream(h);this.rec=new MediaRecorder(n,o),this.rec.ondataavailable=function(t){a.push(t.data)},this.rec.onstop=t=>(this.videoBlob=new Blob(a,{type:i}),a=[],this.isRecording=!1,this.rec=null,this.videoBlob),this.rec.onstart=t=>this.isRecording=!0,this.rec.onresume=t=>this.isRecording=!0,this.rec.onpause=t=>{this.isRecording=!1,this.videoBlob=new Blob(a,{type:i})},this.rec.start()},stop:()=>{if(!this.isRecording)throw Error("Nothing recording");return this.rec.stop()},saveAs:t=>{setTimeout(()=>{if(this.isRecording&&this.rec.stop(),!this.videoBlob)throw Error("No video to save");u(this.videoBlob,t),this.videoBlob=null},64)},toElement:t=>{setTimeout(()=>{if(!this.videoBlob)throw Error("No video to export");const i=document.createElement("video"),{w:e,h:s}=this;i.width=e,i.height=s,i.crossOrigin="anonymous",i.src=URL.createObjectURL(this.videoBlob),i.load(),t(i)},64)}}}}));
//# sourceMappingURL=ctx.min.js.map
