!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).Ctx=i()}(this,(function(){"use strict";const t="arc arcTo beginPath bezierCurveTo clearRect clip closePath createImageData createLinearGradient createRadialGradient createPattern drawFocusRing drawImage fill fillRect fillText getImageData isPointInPath lineTo measureText moveTo putImageData quadraticCurveTo rect restore rotate save scale setTransform stroke strokeRect strokeText transform translate".split(" "),e="canvas fillStyle font globalAlpha globalCompositeOperation lineCap lineJoin lineWidth miterLimit shadowOffsetX shadowOffsetY shadowBlur shadowColor strokeStyle textAlign textBaseline".split(" ");function s(t,i,e){return function(){return t.apply(i,arguments)||e}}function o(t,i,e){return function(s){return void 0===s?i[t]:(i[t]=s,e)}}const n=2*Math.PI,a=Math.PI/180,h=window&&window.devicePixelRatio||1;function r(t,i){let e=document.createElement("a"),s=URL.createObjectURL(t),o=i||"canvas-"+(new Date).valueOf();e.target="_blank",e.href=s,e.download=o,e.click(),window.URL.revokeObjectURL(s)}const c={clear:function(t){t&&this.setTransform(1,0,0,1,0,0),this.clearRect(0,0,this.canvas.width*h,this.canvas.height*h)},size:function(t,i){this.width=t,this.height=i,this.canvas.width=t*h,this.canvas.height=i*h,this.canvas.style.width=t+"px",this.canvas.style.height=i+"px","2d"===this.contextType&&1!==h&&this.context.scale(h,h)},isClean:function(){try{this.getImageData(0,0,1,1);return!0}catch(t){return!1}},line:function(t,i,e,s){this.beginPath(),this.moveTo(t,i),this.lineTo(e,s),this.closePath(),this.fill(),this.stroke()},circle:function(t,i,e){this.beginPath(),this.arc(t,i,e,0,n,!0),this.closePath()},fillCircle:function(t,i,e){c.circle.apply(this,[t,i,e]),this.fill()},strokeCircle:function(t,i,e){c.circle.apply(this,[t,i,e]),this.stroke()},ellipse:function(t,i,e,s){let o,n,a,h,r,c,l;o=.5522848,n=e/2*.5522848,a=s/2*.5522848,h=t+e,c=i+s,r=t+e/2,l=i+s/2,this.moveTo(t,l),this.bezierCurveTo(t,l-a,r-n,i,r,i),this.bezierCurveTo(r+n,i,h,l-a,h,l),this.bezierCurveTo(h,l+a,r+n,c,r,c),this.bezierCurveTo(r-n,c,t,l+a,t,l)},fillEllipse:function(t,i,e,s){this.beginPath(),c.ellipse.apply(this,[t,i,e,s]),this.closePath(),this.fill()},strokeEllipse:function(t,i,e,s){this.beginPath(),c.ellipse.apply(this,[t,i,e,s]),this.closePath(),this.stroke()},ring:function(t,i,e,s){this.beginPath(),this.arc(t,i,e,0,n,!1),this.moveTo(s,0),this.arc(t,i,s,n,0,!0),this.closePath()},fillRing:function(t,i,e,s){c.ring.apply(this,[t,i,e,s]),this.fill()},strokeRing:function(t,i,e,s){c.ring.apply(this,[t,i,e,s]),this.stroke()},roundedRect:function(t,i,e,s,o){this.moveTo(t+o,i),this.arcTo(t+e,i,t+e,i+o,o),this.arcTo(t+e,i+s,t+e-o,i+s,o),this.arcTo(t,i+s,t,i+s-o,o),this.arcTo(t,i,t+o,i,o)},fillRoundedRect:function(t,i,e,s,o){this.beginPath(),c.roundedRect.apply(this,[t,i,e,s,o]),this.closePath(),this.fill()},strokeRoundedRect:function(t,i,e,s,o){this.beginPath(),c.roundedRect.apply(this,[t,i,e,s,o]),this.closePath(),this.stroke()},polygon:function(t,i,e,s,o){const h={x:t,y:i},r=s||6,c=o||0;this.translate(h.x,h.y),this.rotate(c*a),this.beginPath(),this.moveTo(e,0);for(var l=0;l<=n;l+=Math.PI/(r/2))this.lineTo(e*Math.cos(l),e*Math.sin(l));this.closePath(),this.rotate(-c*a),this.translate(-h.x,-h.y)},fillPolygon:function(t,i,e,s,o){const n=s||6,a=o||0;c.polygon.apply(this,[t,i,e,n,a]),this.fill()},strokePolygon:function(t,i,e,s,o){const n=s||6,a=o||0;c.polygon.apply(this,[t,i,e,n,a]),this.stroke()},star:function(t,i,e,s,o){const h={x:t,y:i},r=2*(s||5),c=-90-(o||0);this.translate(h.x,h.y),this.rotate(c*a),this.beginPath(),this.moveTo(e,0);let l=2;for(var u=0;u<=n;u+=Math.PI/(r/2))l=1==l?2:1,this.lineTo(e/l*Math.cos(u),e/l*Math.sin(u));this.closePath(),this.rotate(-c*a),this.translate(-h.x,-h.y)},fillStar:function(t,i,e,s,o){const n=s||5,a=o||0;c.star.apply(this,[t,i,e,n,a]),this.fill()},strokeStar:function(t,i,e,s,o){const n=s||5,a=o||0;c.star.apply(this,[t,i,e,n,a]),this.stroke()},triangle:function(t,i,e,s){c.polygon.apply(this,[t,i,e,3,s||-90])},fillTriangle:function(t,i,e,s){c.polygon.apply(this,[t,i,e,3,s||-90]),this.fill()},strokeTriangle:function(t,i,e,s){c.polygon.apply(this,[t,i,e,3,s||-90]),this.stroke()},curve:function(t,i,e,s){let o;i="number"==typeof i?i:.5,e=e||20;let n,a=[],h=t.length,r=new Float32Array(4*(e+2)),c=4;for(o=t.slice(0),s?(o.unshift(t[h-1]),o.unshift(t[h-2]),o.push(t[0],t[1])):(o.unshift(t[1]),o.unshift(t[0]),o.push(t[h-2],t[h-1])),r[0]=1,n=1;n<e;n++){let t=n/e,i=t*t,s=i*t,o=2*s,a=3*i;r[c++]=o-a+1,r[c++]=a-o,r[c++]=s-2*i+t,r[c++]=s-i}function l(t,s,o){for(let n=2;n<o;n+=2){let o=t[n],h=t[n+1],r=t[n+2],c=t[n+3],l=(r-t[n-2])*i,u=(c-t[n-1])*i,d=(t[n+4]-o)*i,f=(t[n+5]-h)*i;for(let t=0;t<=e;t++){const i=4*t;a.push(s[i]*o+s[i+1]*r+s[i+2]*l+s[i+3]*d,s[i]*h+s[i+1]*c+s[i+2]*u+s[i+3]*f)}}}for(r[++c]=1,l(o,r,h),s&&(o=[],o.push(t[h-4],t[h-3],t[h-2],t[h-1]),o.push(t[0],t[1],t[2],t[3]),l(o,r,4)),n=0,h=a.length;n<h;n+=2)this.lineTo(a[n],a[n+1]);return a},cacheImg:function(t,i,e,s=null,o=null){return this.images=this.images||{},this.images[t]=this.images[t]?this.images[t]:new Image,this.images[t].onload=()=>(this.images[t].width=s,this.images[t].height=o,this.drawImage(this.images[t],i,e,s,o)),this.images[t]},drawImg:function(t,i,e,s,o){return t.outerHTML?this.drawImage(t,i,e,s,o):this.images&&this.images[t]&&this.images[t].src?this.drawImage(this.images[t],i,e,s,o):void(c.cacheImg.apply(this,[t,i,e,s,o]).src=t)},drawSvg:function(t,i,e,s,o){return t.outerHTML?this.drawImage(t,i,e,s,o):this.images&&this.images[t]&&this.images[t].src?this.drawImage(this.images[t],i,e,s,o):void(c.cacheImg.apply(this,[t,i,e,s,o]).src=t.includes("<svg")?"data:image/svg+xml; charset=utf8,"+encodeURIComponent(t):t)},setStyle:function(t){for(i in t)this[i]=t[i]},rotateAt:function(t,i,e){this.translate(t,i),this.rotate(e),this.translate(-t,-i)},distance:function(t,i,e,s){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-s,2))},angleFromPoints:function(t,i,e,s){return Math.atan2(s-e,i-t)},toRadians:function(t){return t*a},random:function(t,i,e){return e?Math.random()*(i-t)+t:Math.floor(Math.random()*(i-t+1))+t}},l=Object.keys(c);return window.Ctx=function(i){let n,a,h=t.length;const u=function(){let t=null,i=["video/webm","video/webm;codecs=vp9","video/vp8","video/webm;codecs=vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mp4","video/mpeg"];for(let e in i)if(MediaRecorder.isTypeSupported(i[e])){t=i[e];break}return t}();for(this.context=i;h--;)n=t[h],this[n]=s(i[n],i,this);for(h=l.length;h--;)n=l[h],this[n]=s(c[n],i,this);for(h=e.length;h--;)n=e[h],this[n]=o(n,i,this);this.canvas=i.canvas,this.image={saveAs:function(t){this.canvas.toBlob(i=>r(i,t))},toElement:function(t){const i=new Image,{w:e,h:s}=this;i.onload=function(){i.width=e,i.height=s,t(i)},i.src=this.canvas.toDataURL("image/png")}},this.video={record:(t,i=u,e=128e3,s=25e5)=>{if(!0===this.isRecording)return;const o=t>0&&t<=60?t:24;a=[];const n={audioBitsPerSecond:e,videoBitsPerSecond:s,mimeType:i},h=this.canvas.captureStream(o);this.rec=new MediaRecorder(h,n),this.rec.ondataavailable=function(t){a.push(t.data)},this.rec.onstop=t=>(this.videoBlob=new Blob(a,{type:i}),a=[],this.isRecording=!1,this.rec=null,this.videoBlob),this.rec.onstart=t=>this.isRecording=!0,this.rec.onresume=t=>this.isRecording=!0,this.rec.onpause=t=>{this.isRecording=!1,this.videoBlob=new Blob(a,{type:i})},this.rec.start()},stop:()=>{if(!this.isRecording)throw Error("No video is recording");return this.rec.stop()},saveAs:t=>{setTimeout(()=>{if(this.isRecording&&this.rec.stop(),!this.videoBlob)throw Error("No video to save");r(this.videoBlob,t),this.videoBlob=null},64)},toElement:t=>{setTimeout(()=>{if(!this.videoBlob)throw Error("No video to export");const i=document.createElement("video"),{w:e,h:s}=this;i.width=e,i.height=s,i.src=URL.createObjectURL(this.videoBlob),i.load(),t(i)},64)}}},Ctx}));
//# sourceMappingURL=ctx.min.js.map
